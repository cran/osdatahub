<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Using the NGD Features API with R</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Using the NGD Features API with R</h1>



<p>The National Geographic Database (NGD) Features API provides access
to Ordnance Survey’s next generation NGD data. The NGD Features API is a
premium or public sector product only. The <a href="https://docs.os.uk/osngd/accessing-os-ngd/access-the-os-ngd-api/os-ngd-api-features">NGD
Features API</a> allows for programmatic access to NGD data in
<code>GeoJSON</code> format. For <code>R</code> developers,
<code>osdatahub</code> library wraps the functionality of the NGD
Features API to make it easy to get data from Ordnance Survey.</p>
<blockquote>
<p>Not using <code>R</code>? There are <a href="https://github.com/OrdnanceSurvey/osdatahub">Python</a> and <a href="https://github.com/OrdnanceSurvey/osdatahub-js">JavaScript</a>
versions of <code>osdatahub</code>.</p>
</blockquote>
<div id="getting-started" class="section level2">
<h2>1. Getting Started</h2>
<div id="importing-the-osdatahub-package" class="section level3">
<h3>Importing the <code>osdatahub</code> package</h3>
<p>Once the package is installed within <code>R</code>, import the
library.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(osdatahub)</span></code></pre></div>
</div>
<div id="importing-your-os-data-hub-api-key" class="section level3">
<h3>Importing your OS Data Hub API Key</h3>
<p>In order to access the NGD, you must first have an OS Data Hub API
key. A notebook explaining the process of registering an account and
getting an API key is available to read <a href="https://github.com/OrdnanceSurvey/osdatahub/blob/master/Examples/Setting%20up%20an%20API%20key.ipynb">here</a>.
When you’re choosing which APIs you want to add to your project, you
must select “OS NGD API - Features” to use NGD data.</p>
<p>Once you have an API key, you can load your API key in by either
passing it in as a string to functions in <code>osdatahub</code>, or
setting it as an environment variable. While you can store your API key
as a string variable in your scripts, you want to protect your API key
and not share it with others.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Option 1.</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># Create an environment variable with your API key.</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># This function is available in the osdatahub package.</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">set_os_key</span>(<span class="st">&#39;YOUR API KEY HERE&#39;</span>)</span></code></pre></div>
<p>Alternatively, you can add the environment variable manually in a
file called <code>.Renviron</code>, typically in your home
directory.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Option 2.</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># Enter the following command in the R console.</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">file.edit</span>(<span class="st">&quot;~/.Renviron&quot;</span>)</span></code></pre></div>
<p>The file looks something like:</p>
<pre><code>VAR1 = value1
VAR2 = value2</code></pre>
<p>Add a variable named: <code>OS_API_KEY</code>. Note that
<code>.Renviron</code> is processed on start-up, so restart
<code>R</code> to see changes. Environment variables are available in
every running R process, and can be read by any other program on your
computer. More secure options see the <a href="https://keyring.r-lib.org/index.html"><code>keyring</code>
package</a>.</p>
</div>
<div id="import-the-osdatahub-package" class="section level3">
<h3>Import the <code>osdatahub</code> package</h3>
<p>To access the NGD API functions from <code>osdatahub</code>, write
the following:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">library</span>(osdatahub)</span></code></pre></div>
</div>
</div>
<div id="discovering-collections" class="section level2">
<h2>2. Discovering Collections</h2>
<p>The NGD contains multiple themes and collections:</p>
<ul>
<li>A <code>theme</code> is a family of <code>collections</code>, for
example, there is a theme called ‘Buildings’.</li>
<li>A <code>collection</code> is a group of features. The Buildings
theme contains two collections: ‘BuildingLine’ and ‘BuildingPart’.</li>
</ul>
<p>You can read more about the NGD Features API’s themes and collections
in the <a href="https://osdatahub.os.uk/docs/ofa/technicalSpecification">Technical
Specification</a>.</p>
<p>To quickly retrieve a data frame of available data, you can query the
API directly:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>ngd_collections <span class="ot">&lt;-</span> <span class="fu">list_ngd_collections</span>(<span class="at">simple =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>This will returna a data.frame object, which we can then iterate
through to return metadata about each collection.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(ngd_collections)){</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  collection <span class="ot">&lt;-</span> ngd_collections[i, ]</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(collection<span class="sc">$</span>title, <span class="st">&#39;(&#39;</span>, collection<span class="sc">$</span>id, <span class="st">&#39;)&#39;</span>))</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>}</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Building v1(bld-fts-building-1)&quot;</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Building v2(bld-fts-building-2)&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Building v3(bld-fts-building-3)&quot;</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Building v4(bld-fts-building-4)&quot;</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Building Access Location v1(bld-fts-buildingaccesslocation-1)&quot;</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Building Line v1(bld-fts-buildingline-1)&quot;</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Building Part v1(bld-fts-buildingpart-1)&quot;</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Building Part v2(bld-fts-buildingpart-2)&quot;</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Crowd Sourced Name Point v1(gnm-fts-crowdsourcednamepoint-1)&quot;</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Named Area v1(gnm-fts-namedarea-1)&quot;</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Named Point v1(gnm-fts-namedpoint-1)&quot;</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Named Road Junction v1(gnm-fts-namedroadjunction-1)&quot;</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Land v1(lnd-fts-land-1)&quot;</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Land v2(lnd-fts-land-2)&quot;</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Land v3(lnd-fts-land-3)&quot;</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Landform v1(lnd-fts-landform-1)&quot;</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Landform Line v1(lnd-fts-landformline-1)&quot;</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Landform Point v1(lnd-fts-landformpoint-1)&quot;</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Land Point v1(lnd-fts-landpoint-1)&quot;</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Site v1(lus-fts-site-1)&quot;</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Site v2(lus-fts-site-2)&quot;</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Site Access Location v1(lus-fts-siteaccesslocation-1)&quot;</span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Site Access Location v2(lus-fts-siteaccesslocation-2)&quot;</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Site Routing Point v1(lus-fts-siteroutingpoint-1)&quot;</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Compound Structure v1(str-fts-compoundstructure-1)&quot;</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Compound Structure v2(str-fts-compoundstructure-2)&quot;</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Field Boundary v1(str-fts-fieldboundary-1)&quot;</span></span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Structure v1(str-fts-structure-1)&quot;</span></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Structure v2(str-fts-structure-2)&quot;</span></span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Structure v3(str-fts-structure-3)&quot;</span></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Structure Line v1(str-fts-structureline-1)&quot;</span></span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Structure Point v1(str-fts-structurepoint-1)&quot;</span></span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Cartographic Rail Detail v1(trn-fts-cartographicraildetail-1)&quot;</span></span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Rail v1(trn-fts-rail-1)&quot;</span></span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Rail v2(trn-fts-rail-2)&quot;</span></span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Rail v3(trn-fts-rail-3)&quot;</span></span>
<span id="cb7-42"><a href="#cb7-42" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Line v1(trn-fts-roadline-1)&quot;</span></span>
<span id="cb7-43"><a href="#cb7-43" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Track Or Path v1(trn-fts-roadtrackorpath-1)&quot;</span></span>
<span id="cb7-44"><a href="#cb7-44" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Track Or Path v2(trn-fts-roadtrackorpath-2)&quot;</span></span>
<span id="cb7-45"><a href="#cb7-45" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Track Or Path v3(trn-fts-roadtrackorpath-3)&quot;</span></span>
<span id="cb7-46"><a href="#cb7-46" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Street Light v1(trn-fts-streetlight-1)&quot;</span></span>
<span id="cb7-47"><a href="#cb7-47" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Connecting Link v1(trn-ntwk-connectinglink-1)&quot;</span></span>
<span id="cb7-48"><a href="#cb7-48" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Connecting Node v1(trn-ntwk-connectingnode-1)&quot;</span></span>
<span id="cb7-49"><a href="#cb7-49" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Ferry Link v1(trn-ntwk-ferrylink-1)&quot;</span></span>
<span id="cb7-50"><a href="#cb7-50" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Ferry Node v1(trn-ntwk-ferrynode-1)&quot;</span></span>
<span id="cb7-51"><a href="#cb7-51" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Ferry Terminal v1(trn-ntwk-ferryterminal-1)&quot;</span></span>
<span id="cb7-52"><a href="#cb7-52" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Path v1(trn-ntwk-path-1)&quot;</span></span>
<span id="cb7-53"><a href="#cb7-53" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Path Link v1(trn-ntwk-pathlink-1)&quot;</span></span>
<span id="cb7-54"><a href="#cb7-54" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Path Link v2(trn-ntwk-pathlink-2)&quot;</span></span>
<span id="cb7-55"><a href="#cb7-55" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Path Node v1(trn-ntwk-pathnode-1)&quot;</span></span>
<span id="cb7-56"><a href="#cb7-56" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Pavement Link v1(trn-ntwk-pavementlink-1)&quot;</span></span>
<span id="cb7-57"><a href="#cb7-57" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Railway Link v1(trn-ntwk-railwaylink-1)&quot;</span></span>
<span id="cb7-58"><a href="#cb7-58" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Railway Link Set v1(trn-ntwk-railwaylinkset-1)&quot;</span></span>
<span id="cb7-59"><a href="#cb7-59" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Railway Node v1(trn-ntwk-railwaynode-1)&quot;</span></span>
<span id="cb7-60"><a href="#cb7-60" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road v1(trn-ntwk-road-1)&quot;</span></span>
<span id="cb7-61"><a href="#cb7-61" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Junction v1(trn-ntwk-roadjunction-1)&quot;</span></span>
<span id="cb7-62"><a href="#cb7-62" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Link v1(trn-ntwk-roadlink-1)&quot;</span></span>
<span id="cb7-63"><a href="#cb7-63" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Link v2(trn-ntwk-roadlink-2)&quot;</span></span>
<span id="cb7-64"><a href="#cb7-64" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Link v3(trn-ntwk-roadlink-3)&quot;</span></span>
<span id="cb7-65"><a href="#cb7-65" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Link v4(trn-ntwk-roadlink-4)&quot;</span></span>
<span id="cb7-66"><a href="#cb7-66" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Node v1(trn-ntwk-roadnode-1)&quot;</span></span>
<span id="cb7-67"><a href="#cb7-67" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Street v1(trn-ntwk-street-1)&quot;</span></span>
<span id="cb7-68"><a href="#cb7-68" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Tram On Road v1(trn-ntwk-tramonroad-1)&quot;</span></span>
<span id="cb7-69"><a href="#cb7-69" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Average And Indicative Speed v1(trn-rami-averageandindicativespeed-1)&quot;</span></span>
<span id="cb7-70"><a href="#cb7-70" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Highway Dedication v1(trn-rami-highwaydedication-1)&quot;</span></span>
<span id="cb7-71"><a href="#cb7-71" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Maintenance Area v1(trn-rami-maintenancearea-1)&quot;</span></span>
<span id="cb7-72"><a href="#cb7-72" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Maintenance Line v1(trn-rami-maintenanceline-1)&quot;</span></span>
<span id="cb7-73"><a href="#cb7-73" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Maintenance Point v1(trn-rami-maintenancepoint-1)&quot;</span></span>
<span id="cb7-74"><a href="#cb7-74" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Reinstatement Area v1(trn-rami-reinstatementarea-1)&quot;</span></span>
<span id="cb7-75"><a href="#cb7-75" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Reinstatement Line v1(trn-rami-reinstatementline-1)&quot;</span></span>
<span id="cb7-76"><a href="#cb7-76" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Reinstatement Point v1(trn-rami-reinstatementpoint-1)&quot;</span></span>
<span id="cb7-77"><a href="#cb7-77" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Restriction v1(trn-rami-restriction-1)&quot;</span></span>
<span id="cb7-78"><a href="#cb7-78" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Routing Hazard v1(trn-rami-routinghazard-1)&quot;</span></span>
<span id="cb7-79"><a href="#cb7-79" tabindex="-1"></a><span class="co">#&gt; [1] &quot;RoutingStructure v1(trn-rami-routingstructure-1)&quot;</span></span>
<span id="cb7-80"><a href="#cb7-80" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Special Designation Area v1(trn-rami-specialdesignationarea-1)&quot;</span></span>
<span id="cb7-81"><a href="#cb7-81" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Special Designation Line v1(trn-rami-specialdesignationline-1)&quot;</span></span>
<span id="cb7-82"><a href="#cb7-82" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Special Designation Point v1(trn-rami-specialdesignationpoint-1)&quot;</span></span>
<span id="cb7-83"><a href="#cb7-83" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Inter Tidal Line v1(wtr-fts-intertidalline-1)&quot;</span></span>
<span id="cb7-84"><a href="#cb7-84" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Tidal Boundary v1(wtr-fts-tidalboundary-1)&quot;</span></span>
<span id="cb7-85"><a href="#cb7-85" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Water v1(wtr-fts-water-1)&quot;</span></span>
<span id="cb7-86"><a href="#cb7-86" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Water v2(wtr-fts-water-2)&quot;</span></span>
<span id="cb7-87"><a href="#cb7-87" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Water v3(wtr-fts-water-3)&quot;</span></span>
<span id="cb7-88"><a href="#cb7-88" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Water Point v1(wtr-fts-waterpoint-1)&quot;</span></span>
<span id="cb7-89"><a href="#cb7-89" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Water Link v1(wtr-ntwk-waterlink-1)&quot;</span></span>
<span id="cb7-90"><a href="#cb7-90" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Water Link Set v1(wtr-ntwk-waterlinkset-1)&quot;</span></span>
<span id="cb7-91"><a href="#cb7-91" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Water Node v1(wtr-ntwk-waternode-1)&quot;</span></span></code></pre></div>
</div>
<div id="loading-ngd-data-into-a-spatial-data-frame" class="section level2">
<h2>3. Loading NGD Data into a Spatial Data Frame</h2>
<p>We’ll now walk through the process of acquiring data from the NGD
Building Part collection (<code>bld-fts-buildingpart-1</code>) and
importing this data into a an object of type <code>sf</code>.</p>
<div id="requesting-ngd-data" class="section level3">
<h3>Requesting NGD Data</h3>
<p>To get the first 100 features in the collection, you simply need to
query use the NGD query function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>collection <span class="ot">&lt;-</span> <span class="st">&#39;bld-fts-buildingpart-1&#39;</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># make the query and contact the API</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># reduce the number of features returned for the example</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>features <span class="ot">&lt;-</span> <span class="fu">query_ngd</span>(<span class="at">collection =</span> collection, <span class="at">max_results =</span> <span class="dv">4</span>)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>features</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; {&quot;type&quot;:&quot;FeatureCollection&quot;,&quot;features&quot;:[{&quot;type&quot;:&quot;Feature&quot;,&quot;properties&quot;:{&quot;osid&quot;:&quot;000000b1-0556-4231-a52a-9b5b8b82dfbf&quot;,&quot;toid&quot;:&quot;osgb1000041024621&quot;,&quot;theme&quot;:&quot;Buildings&quot;,&quot;changetype&quot;:&quot;Modified Attributes&quot;,&quot;isobscured&quot;:false,&quot;description&quot;:&quot;Building&quot;,&quot;versiondate&quot;:&quot;2025-02-20&quot;,&quot;geometry_area&quot;:59.20065,&quot;height_source&quot;:&quot;Ordnance Survey&quot;,&quot;physicallevel&quot;:&quot;Surface Level&quot;,&quot;oslandusetiera&quot;:&quot;Residential Accommodation&quot;,&quot;oslandusetierb&quot;:&quot;[\&quot;Private Residence\&quot;]&quot;,&quot;geometry_source&quot;:&quot;Ordnance Survey&quot;,&quot;oslandcovertiera&quot;:&quot;Constructed&quot;,&quot;oslandcovertierb&quot;:&quot;[\&quot;Building\&quot;]&quot;,&quot;oslanduse_source&quot;:&quot;Ordnance Survey&quot;,&quot;height_updatedate&quot;:&quot;2025-01-17&quot;,&quot;description_source&quot;:&quot;Ordnance Survey&quot;,&quot;oslandcover_source&quot;:&quot;Ordnance Survey&quot;,&quot;associatedstructure&quot;:null,&quot;geometry_updatedate&quot;:&quot;2006-08-30&quot;,&quot;height_evidencedate&quot;:&quot;2022-06-20&quot;,&quot;capturespecification&quot;:&quot;Urban&quot;,&quot;oslanduse_updatedate&quot;:&quot;2006-08-30&quot;,&quot;absoluteheightmaximum&quot;:115.2,&quot;absoluteheightminimum&quot;:105.0,&quot;geometry_evidencedate&quot;:&quot;2006-08-30&quot;,&quot;heightconfidencelevel&quot;:&quot;Moderate&quot;,&quot;relativeheightmaximum&quot;:10.2,&quot;absoluteheightroofbase&quot;:111.2,&quot;description_updatedate&quot;:&quot;2006-08-30&quot;,&quot;oslandcover_updatedate&quot;:&quot;2006-08-30&quot;,&quot;oslanduse_evidencedate&quot;:&quot;2006-08-30&quot;,&quot;relativeheightroofbase&quot;:6.2,&quot;versionavailabletodate&quot;:null,&quot;firstdigitalcapturedate&quot;:&quot;1991-09-18&quot;,&quot;description_evidencedate&quot;:&quot;2006-08-30&quot;,&quot;oslandcover_evidencedate&quot;:&quot;2006-08-30&quot;,&quot;versionavailablefromdate&quot;:&quot;2025-02-21T00:00:00Z&quot;},&quot;geometry&quot;:{&quot;type&quot;:&quot;Polygon&quot;,&quot;coordinates&quot;:[[[-3.9703075,55.7425473],[-3.9701862,55.7424916],[-3.9701342,55.7425277],[-3.9702899,55.7425992],[-3.9703201,55.7425783],[-3.9702857,55.7425625],[-3.9703075,55.7425473]]]}},{&quot;type&quot;:&quot;Feature&quot;,&quot;properties&quot;:{&quot;osid&quot;:&quot;00000183-3ae0-4f05-adb8-a5792d09f55f&quot;,&quot;toid&quot;:&quot;osgb5000005167584940&quot;,&quot;theme&quot;:&quot;Buildings&quot;,&quot;changetype&quot;:&quot;Modified Attributes&quot;,&quot;isobscured&quot;:false,&quot;description&quot;:&quot;Building&quot;,&quot;versiondate&quot;:&quot;2025-02-15&quot;,&quot;geometry_area&quot;:9.499142,&quot;height_source&quot;:&quot;Ordnance Survey&quot;,&quot;physicallevel&quot;:&quot;Surface Level&quot;,&quot;oslandusetiera&quot;:&quot;Residential Accommodation&quot;,&quot;oslandusetierb&quot;:&quot;[\&quot;Private Residence\&quot;]&quot;,&quot;geometry_source&quot;:&quot;Ordnance Survey&quot;,&quot;oslandcovertiera&quot;:&quot;Constructed&quot;,&quot;oslandcovertierb&quot;:&quot;[\&quot;Building\&quot;]&quot;,&quot;oslanduse_source&quot;:&quot;Ordnance Survey&quot;,&quot;height_updatedate&quot;:&quot;2025-01-17&quot;,&quot;description_source&quot;:&quot;Ordnance Survey&quot;,&quot;oslandcover_source&quot;:&quot;Ordnance Survey&quot;,&quot;associatedstructure&quot;:null,&quot;geometry_updatedate&quot;:&quot;2015-10-29&quot;,&quot;height_evidencedate&quot;:&quot;2024-11-18&quot;,&quot;capturespecification&quot;:&quot;Rural&quot;,&quot;oslanduse_updatedate&quot;:&quot;2015-10-29&quot;,&quot;absoluteheightmaximum&quot;:null,&quot;absoluteheightminimum&quot;:5.4,&quot;geometry_evidencedate&quot;:&quot;2015-03-11&quot;,&quot;heightconfidencelevel&quot;:&quot;Incomplete&quot;,&quot;relativeheightmaximum&quot;:null,&quot;absoluteheightroofbase&quot;:null,&quot;description_updatedate&quot;:&quot;2015-10-29&quot;,&quot;oslandcover_updatedate&quot;:&quot;2015-10-29&quot;,&quot;oslanduse_evidencedate&quot;:&quot;2015-03-11&quot;,&quot;relativeheightroofbase&quot;:null,&quot;versionavailabletodate&quot;:null,&quot;firstdigitalcapturedate&quot;:&quot;2015-11-12&quot;,&quot;description_evidencedate&quot;:&quot;2015-03-11&quot;,&quot;oslandcover_evidencedate&quot;:&quot;2015-03-11&quot;,&quot;versionavailablefromdate&quot;:&quot;2025-02-16T00:00:00Z&quot;},&quot;geometry&quot;:{&quot;type&quot;:&quot;Polygon&quot;,&quot;coordinates&quot;:[[[1.7275593,52.6614194],[1.7275547,52.6614375],[1.7274869,52.6614311],[1.7274915,52.661413],[1.7275593,52.6614194]]]}},{&quot;type&quot;:&quot;Feature&quot;,&quot;properties&quot;:{&quot;osid&quot;:&quot;000001d6-8217-4f7a-a70e-3757eb76c9e4&quot;,&quot;toid&quot;:&quot;osgb1000000360448&quot;,&quot;theme&quot;:&quot;Buildings&quot;,&quot;changetype&quot;:&quot;Modified Attributes&quot;,&quot;isobscured&quot;:false,&quot;description&quot;:&quot;Building&quot;,&quot;versiondate&quot;:&quot;2025-02-10&quot;,&quot;geometry_area&quot;:15.25875,&quot;height_source&quot;:&quot;Ordnance Survey&quot;,&quot;physicallevel&quot;:&quot;Surface Level&quot;,&quot;oslandusetiera&quot;:&quot;Residential Accommodation&quot;,&quot;oslandusetierb&quot;:&quot;[\&quot;Private Residence\&quot;]&quot;,&quot;geometry_source&quot;:&quot;Ordnance Survey&quot;,&quot;oslandcovertiera&quot;:&quot;Constructed&quot;,&quot;oslandcovertierb&quot;:&quot;[\&quot;Building\&quot;]&quot;,&quot;oslanduse_source&quot;:&quot;Ordnance Survey&quot;,&quot;height_updatedate&quot;:&quot;2025-01-17&quot;,&quot;description_source&quot;:&quot;Ordnance Survey&quot;,&quot;oslandcover_source&quot;:&quot;Ordnance Survey&quot;,&quot;associatedstructure&quot;:null,&quot;geometry_updatedate&quot;:&quot;1993-04-01&quot;,&quot;height_evidencedate&quot;:&quot;2022-07-10&quot;,&quot;capturespecification&quot;:&quot;Urban&quot;,&quot;oslanduse_updatedate&quot;:&quot;1993-04-01&quot;,&quot;absoluteheightmaximum&quot;:38.6,&quot;absoluteheightminimum&quot;:34.7,&quot;geometry_evidencedate&quot;:&quot;1993-04-01&quot;,&quot;heightconfidencelevel&quot;:&quot;Moderate&quot;,&quot;relativeheightmaximum&quot;:3.9,&quot;absoluteheightroofbase&quot;:37.3,&quot;description_updatedate&quot;:&quot;1993-04-01&quot;,&quot;oslandcover_updatedate&quot;:&quot;1993-04-01&quot;,&quot;oslanduse_evidencedate&quot;:&quot;1993-04-01&quot;,&quot;relativeheightroofbase&quot;:2.6,&quot;versionavailabletodate&quot;:null,&quot;firstdigitalcapturedate&quot;:&quot;1993-04-01&quot;,&quot;description_evidencedate&quot;:&quot;1993-04-01&quot;,&quot;oslandcover_evidencedate&quot;:&quot;1993-04-01&quot;,&quot;versionavailablefromdate&quot;:&quot;2025-02-11T00:00:00Z&quot;},&quot;geometry&quot;:{&quot;type&quot;:&quot;Polygon&quot;,&quot;coordinates&quot;:[[[0.1941514,51.5924144],[0.194112,51.5924057],[0.194138,51.5923612],[0.1941775,51.5923703],[0.1941514,51.5924144]]]}},{&quot;type&quot;:&quot;Feature&quot;,&quot;properties&quot;:{&quot;osid&quot;:&quot;00000208-a659-49f9-a587-ab26cb2b2248&quot;,&quot;toid&quot;:&quot;osgb1000017249389&quot;,&quot;theme&quot;:&quot;Buildings&quot;,&quot;changetype&quot;:&quot;Modified Attributes&quot;,&quot;isobscured&quot;:false,&quot;description&quot;:&quot;Building&quot;,&quot;versiondate&quot;:&quot;2025-02-13&quot;,&quot;geometry_area&quot;:12.80625,&quot;height_source&quot;:&quot;Ordnance Survey&quot;,&quot;physicallevel&quot;:&quot;Surface Level&quot;,&quot;oslandusetiera&quot;:&quot;Unknown Or Unused Artificial&quot;,&quot;oslandusetierb&quot;:&quot;[]&quot;,&quot;geometry_source&quot;:&quot;Ordnance Survey&quot;,&quot;oslandcovertiera&quot;:&quot;Constructed&quot;,&quot;oslandcovertierb&quot;:&quot;[\&quot;Building\&quot;]&quot;,&quot;oslanduse_source&quot;:&quot;Ordnance Survey&quot;,&quot;height_updatedate&quot;:&quot;2025-01-17&quot;,&quot;description_source&quot;:&quot;Ordnance Survey&quot;,&quot;oslandcover_source&quot;:&quot;Ordnance Survey&quot;,&quot;associatedstructure&quot;:null,&quot;geometry_updatedate&quot;:&quot;1993-05-01&quot;,&quot;height_evidencedate&quot;:&quot;2024-08-21&quot;,&quot;capturespecification&quot;:&quot;Urban&quot;,&quot;oslanduse_updatedate&quot;:&quot;1993-05-01&quot;,&quot;absoluteheightmaximum&quot;:null,&quot;absoluteheightminimum&quot;:70.0,&quot;geometry_evidencedate&quot;:&quot;1993-05-01&quot;,&quot;heightconfidencelevel&quot;:&quot;Incomplete&quot;,&quot;relativeheightmaximum&quot;:null,&quot;absoluteheightroofbase&quot;:null,&quot;description_updatedate&quot;:&quot;1993-05-01&quot;,&quot;oslandcover_updatedate&quot;:&quot;1993-05-01&quot;,&quot;oslanduse_evidencedate&quot;:&quot;1993-05-01&quot;,&quot;relativeheightroofbase&quot;:null,&quot;versionavailabletodate&quot;:null,&quot;firstdigitalcapturedate&quot;:&quot;1993-05-01&quot;,&quot;description_evidencedate&quot;:&quot;1993-05-01&quot;,&quot;oslandcover_evidencedate&quot;:&quot;1993-05-01&quot;,&quot;versionavailablefromdate&quot;:&quot;2025-02-14T00:00:00Z&quot;},&quot;geometry&quot;:{&quot;type&quot;:&quot;Polygon&quot;,&quot;coordinates&quot;:[[[-1.454721,52.3961029],[-1.4547862,52.3961253],[-1.454804,52.3961051],[-1.4547382,52.3960832],[-1.454721,52.3961029]]]}}]}</span></span></code></pre></div>
<p>The API returns an OGC-compliant GeoJSON, which is easy to import
into other libraries for analysis.</p>
</div>
<div id="importing-into-a-spatial-data-frame" class="section level3">
<h3>Importing into a spatial data frame</h3>
<p>If you haven’t already, install and import the <code>sf</code>
library:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; Linking to GEOS 3.9.1, GDAL 3.3.2, PROJ 7.2.1; sf_use_s2() is TRUE</span></span></code></pre></div>
<p>And now, import the NGD data.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>gdf <span class="ot">=</span> <span class="fu">st_read</span>(features, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Let’s take a look at a preview of the data using <code>head()</code>.
As you’ll see, NGD data is rich in attribution:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">head</span>(gdf)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 4 features and 39 fields</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -3.97032 ymin: 51.59236 xmax: 1.727559 ymax: 55.7426</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt;                                   osid                 toid     theme</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; 1 000000b1-0556-4231-a52a-9b5b8b82dfbf    osgb1000041024621 Buildings</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; 2 00000183-3ae0-4f05-adb8-a5792d09f55f osgb5000005167584940 Buildings</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; 3 000001d6-8217-4f7a-a70e-3757eb76c9e4    osgb1000000360448 Buildings</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; 4 00000208-a659-49f9-a587-ab26cb2b2248    osgb1000017249389 Buildings</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt;            changetype isobscured description versiondate geometry_area</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; 1 Modified Attributes      FALSE    Building  2025-02-20     59.200650</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; 2 Modified Attributes      FALSE    Building  2025-02-15      9.499142</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; 3 Modified Attributes      FALSE    Building  2025-02-10     15.258750</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; 4 Modified Attributes      FALSE    Building  2025-02-13     12.806250</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt;     height_source physicallevel               oslandusetiera</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; 1 Ordnance Survey Surface Level    Residential Accommodation</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; 2 Ordnance Survey Surface Level    Residential Accommodation</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt; 3 Ordnance Survey Surface Level    Residential Accommodation</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; 4 Ordnance Survey Surface Level Unknown Or Unused Artificial</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt;          oslandusetierb geometry_source oslandcovertiera oslandcovertierb</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; 1 [&quot;Private Residence&quot;] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt; 2 [&quot;Private Residence&quot;] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt; 3 [&quot;Private Residence&quot;] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt; 4                    [] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="co">#&gt;   oslanduse_source height_updatedate description_source oslandcover_source</span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="co">#&gt; 1  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt; 2  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt; 3  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a><span class="co">#&gt; 4  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="co">#&gt;   associatedstructure geometry_updatedate height_evidencedate</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a><span class="co">#&gt; 1                &lt;NA&gt;          2006-08-30          2022-06-20</span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="co">#&gt; 2                &lt;NA&gt;          2015-10-29          2024-11-18</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="co">#&gt; 3                &lt;NA&gt;          1993-04-01          2022-07-10</span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a><span class="co">#&gt; 4                &lt;NA&gt;          1993-05-01          2024-08-21</span></span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a><span class="co">#&gt;   capturespecification oslanduse_updatedate absoluteheightmaximum</span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a><span class="co">#&gt; 1                Urban           2006-08-30                 115.2</span></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="co">#&gt; 2                Rural           2015-10-29                    NA</span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a><span class="co">#&gt; 3                Urban           1993-04-01                  38.6</span></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a><span class="co">#&gt; 4                Urban           1993-05-01                    NA</span></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a><span class="co">#&gt;   absoluteheightminimum geometry_evidencedate heightconfidencelevel</span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a><span class="co">#&gt; 1                 105.0            2006-08-30              Moderate</span></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a><span class="co">#&gt; 2                   5.4            2015-03-11            Incomplete</span></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a><span class="co">#&gt; 3                  34.7            1993-04-01              Moderate</span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a><span class="co">#&gt; 4                  70.0            1993-05-01            Incomplete</span></span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a><span class="co">#&gt;   relativeheightmaximum absoluteheightroofbase description_updatedate</span></span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a><span class="co">#&gt; 1                  10.2                  111.2             2006-08-30</span></span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a><span class="co">#&gt; 2                    NA                     NA             2015-10-29</span></span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a><span class="co">#&gt; 3                   3.9                   37.3             1993-04-01</span></span>
<span id="cb11-51"><a href="#cb11-51" tabindex="-1"></a><span class="co">#&gt; 4                    NA                     NA             1993-05-01</span></span>
<span id="cb11-52"><a href="#cb11-52" tabindex="-1"></a><span class="co">#&gt;   oslandcover_updatedate oslanduse_evidencedate relativeheightroofbase</span></span>
<span id="cb11-53"><a href="#cb11-53" tabindex="-1"></a><span class="co">#&gt; 1             2006-08-30             2006-08-30                    6.2</span></span>
<span id="cb11-54"><a href="#cb11-54" tabindex="-1"></a><span class="co">#&gt; 2             2015-10-29             2015-03-11                     NA</span></span>
<span id="cb11-55"><a href="#cb11-55" tabindex="-1"></a><span class="co">#&gt; 3             1993-04-01             1993-04-01                    2.6</span></span>
<span id="cb11-56"><a href="#cb11-56" tabindex="-1"></a><span class="co">#&gt; 4             1993-05-01             1993-05-01                     NA</span></span>
<span id="cb11-57"><a href="#cb11-57" tabindex="-1"></a><span class="co">#&gt;   versionavailabletodate firstdigitalcapturedate description_evidencedate</span></span>
<span id="cb11-58"><a href="#cb11-58" tabindex="-1"></a><span class="co">#&gt; 1                   &lt;NA&gt;              1991-09-18               2006-08-30</span></span>
<span id="cb11-59"><a href="#cb11-59" tabindex="-1"></a><span class="co">#&gt; 2                   &lt;NA&gt;              2015-11-12               2015-03-11</span></span>
<span id="cb11-60"><a href="#cb11-60" tabindex="-1"></a><span class="co">#&gt; 3                   &lt;NA&gt;              1993-04-01               1993-04-01</span></span>
<span id="cb11-61"><a href="#cb11-61" tabindex="-1"></a><span class="co">#&gt; 4                   &lt;NA&gt;              1993-05-01               1993-05-01</span></span>
<span id="cb11-62"><a href="#cb11-62" tabindex="-1"></a><span class="co">#&gt;   oslandcover_evidencedate versionavailablefromdate</span></span>
<span id="cb11-63"><a href="#cb11-63" tabindex="-1"></a><span class="co">#&gt; 1               2006-08-30               2025-02-21</span></span>
<span id="cb11-64"><a href="#cb11-64" tabindex="-1"></a><span class="co">#&gt; 2               2015-03-11               2025-02-16</span></span>
<span id="cb11-65"><a href="#cb11-65" tabindex="-1"></a><span class="co">#&gt; 3               1993-04-01               2025-02-11</span></span>
<span id="cb11-66"><a href="#cb11-66" tabindex="-1"></a><span class="co">#&gt; 4               1993-05-01               2025-02-14</span></span>
<span id="cb11-67"><a href="#cb11-67" tabindex="-1"></a><span class="co">#&gt;                         geometry</span></span>
<span id="cb11-68"><a href="#cb11-68" tabindex="-1"></a><span class="co">#&gt; 1 POLYGON ((-3.970308 55.7425...</span></span>
<span id="cb11-69"><a href="#cb11-69" tabindex="-1"></a><span class="co">#&gt; 2 POLYGON ((1.727559 52.66142...</span></span>
<span id="cb11-70"><a href="#cb11-70" tabindex="-1"></a><span class="co">#&gt; 3 POLYGON ((0.1941514 51.5924...</span></span>
<span id="cb11-71"><a href="#cb11-71" tabindex="-1"></a><span class="co">#&gt; 4 POLYGON ((-1.454721 52.3961...</span></span></code></pre></div>
<p>Alternatively, it’s possible to return an <code>sf</code> object
directly from the NGD query function:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># retrieve features and automatically convert to spatial data frame</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>features <span class="ot">&lt;-</span> <span class="fu">query_ngd</span>(<span class="at">collection =</span> collection,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                      <span class="at">max_results =</span> <span class="dv">4</span>,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                      <span class="at">returnType =</span> <span class="st">&#39;sf&#39;</span>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">head</span>(features)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 4 features and 39 fields</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -3.97032 ymin: 51.59236 xmax: 1.727559 ymax: 55.7426</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt;                                   osid                 toid     theme</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; 1 000000b1-0556-4231-a52a-9b5b8b82dfbf    osgb1000041024621 Buildings</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; 2 00000183-3ae0-4f05-adb8-a5792d09f55f osgb5000005167584940 Buildings</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; 3 000001d6-8217-4f7a-a70e-3757eb76c9e4    osgb1000000360448 Buildings</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; 4 00000208-a659-49f9-a587-ab26cb2b2248    osgb1000017249389 Buildings</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt;            changetype isobscured description versiondate geometry_area</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; 1 Modified Attributes      FALSE    Building  2025-02-20     59.200650</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; 2 Modified Attributes      FALSE    Building  2025-02-15      9.499142</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; 3 Modified Attributes      FALSE    Building  2025-02-10     15.258750</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt; 4 Modified Attributes      FALSE    Building  2025-02-13     12.806250</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt;     height_source physicallevel               oslandusetiera</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt; 1 Ordnance Survey Surface Level    Residential Accommodation</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt; 2 Ordnance Survey Surface Level    Residential Accommodation</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co">#&gt; 3 Ordnance Survey Surface Level    Residential Accommodation</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co">#&gt; 4 Ordnance Survey Surface Level Unknown Or Unused Artificial</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="co">#&gt;          oslandusetierb geometry_source oslandcovertiera oslandcovertierb</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="co">#&gt; 1 [&quot;Private Residence&quot;] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co">#&gt; 2 [&quot;Private Residence&quot;] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co">#&gt; 3 [&quot;Private Residence&quot;] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="co">#&gt; 4                    [] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a><span class="co">#&gt;   oslanduse_source height_updatedate description_source oslandcover_source</span></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a><span class="co">#&gt; 1  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a><span class="co">#&gt; 2  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a><span class="co">#&gt; 3  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a><span class="co">#&gt; 4  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a><span class="co">#&gt;   associatedstructure geometry_updatedate height_evidencedate</span></span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a><span class="co">#&gt; 1                &lt;NA&gt;          2006-08-30          2022-06-20</span></span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a><span class="co">#&gt; 2                &lt;NA&gt;          2015-10-29          2024-11-18</span></span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a><span class="co">#&gt; 3                &lt;NA&gt;          1993-04-01          2022-07-10</span></span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a><span class="co">#&gt; 4                &lt;NA&gt;          1993-05-01          2024-08-21</span></span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a><span class="co">#&gt;   capturespecification oslanduse_updatedate absoluteheightmaximum</span></span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a><span class="co">#&gt; 1                Urban           2006-08-30                 115.2</span></span>
<span id="cb12-44"><a href="#cb12-44" tabindex="-1"></a><span class="co">#&gt; 2                Rural           2015-10-29                    NA</span></span>
<span id="cb12-45"><a href="#cb12-45" tabindex="-1"></a><span class="co">#&gt; 3                Urban           1993-04-01                  38.6</span></span>
<span id="cb12-46"><a href="#cb12-46" tabindex="-1"></a><span class="co">#&gt; 4                Urban           1993-05-01                    NA</span></span>
<span id="cb12-47"><a href="#cb12-47" tabindex="-1"></a><span class="co">#&gt;   absoluteheightminimum geometry_evidencedate heightconfidencelevel</span></span>
<span id="cb12-48"><a href="#cb12-48" tabindex="-1"></a><span class="co">#&gt; 1                 105.0            2006-08-30              Moderate</span></span>
<span id="cb12-49"><a href="#cb12-49" tabindex="-1"></a><span class="co">#&gt; 2                   5.4            2015-03-11            Incomplete</span></span>
<span id="cb12-50"><a href="#cb12-50" tabindex="-1"></a><span class="co">#&gt; 3                  34.7            1993-04-01              Moderate</span></span>
<span id="cb12-51"><a href="#cb12-51" tabindex="-1"></a><span class="co">#&gt; 4                  70.0            1993-05-01            Incomplete</span></span>
<span id="cb12-52"><a href="#cb12-52" tabindex="-1"></a><span class="co">#&gt;   relativeheightmaximum absoluteheightroofbase description_updatedate</span></span>
<span id="cb12-53"><a href="#cb12-53" tabindex="-1"></a><span class="co">#&gt; 1                  10.2                  111.2             2006-08-30</span></span>
<span id="cb12-54"><a href="#cb12-54" tabindex="-1"></a><span class="co">#&gt; 2                    NA                     NA             2015-10-29</span></span>
<span id="cb12-55"><a href="#cb12-55" tabindex="-1"></a><span class="co">#&gt; 3                   3.9                   37.3             1993-04-01</span></span>
<span id="cb12-56"><a href="#cb12-56" tabindex="-1"></a><span class="co">#&gt; 4                    NA                     NA             1993-05-01</span></span>
<span id="cb12-57"><a href="#cb12-57" tabindex="-1"></a><span class="co">#&gt;   oslandcover_updatedate oslanduse_evidencedate relativeheightroofbase</span></span>
<span id="cb12-58"><a href="#cb12-58" tabindex="-1"></a><span class="co">#&gt; 1             2006-08-30             2006-08-30                    6.2</span></span>
<span id="cb12-59"><a href="#cb12-59" tabindex="-1"></a><span class="co">#&gt; 2             2015-10-29             2015-03-11                     NA</span></span>
<span id="cb12-60"><a href="#cb12-60" tabindex="-1"></a><span class="co">#&gt; 3             1993-04-01             1993-04-01                    2.6</span></span>
<span id="cb12-61"><a href="#cb12-61" tabindex="-1"></a><span class="co">#&gt; 4             1993-05-01             1993-05-01                     NA</span></span>
<span id="cb12-62"><a href="#cb12-62" tabindex="-1"></a><span class="co">#&gt;   versionavailabletodate firstdigitalcapturedate description_evidencedate</span></span>
<span id="cb12-63"><a href="#cb12-63" tabindex="-1"></a><span class="co">#&gt; 1                   &lt;NA&gt;              1991-09-18               2006-08-30</span></span>
<span id="cb12-64"><a href="#cb12-64" tabindex="-1"></a><span class="co">#&gt; 2                   &lt;NA&gt;              2015-11-12               2015-03-11</span></span>
<span id="cb12-65"><a href="#cb12-65" tabindex="-1"></a><span class="co">#&gt; 3                   &lt;NA&gt;              1993-04-01               1993-04-01</span></span>
<span id="cb12-66"><a href="#cb12-66" tabindex="-1"></a><span class="co">#&gt; 4                   &lt;NA&gt;              1993-05-01               1993-05-01</span></span>
<span id="cb12-67"><a href="#cb12-67" tabindex="-1"></a><span class="co">#&gt;   oslandcover_evidencedate versionavailablefromdate</span></span>
<span id="cb12-68"><a href="#cb12-68" tabindex="-1"></a><span class="co">#&gt; 1               2006-08-30     2025-02-21T00:00:00Z</span></span>
<span id="cb12-69"><a href="#cb12-69" tabindex="-1"></a><span class="co">#&gt; 2               2015-03-11     2025-02-16T00:00:00Z</span></span>
<span id="cb12-70"><a href="#cb12-70" tabindex="-1"></a><span class="co">#&gt; 3               1993-04-01     2025-02-11T00:00:00Z</span></span>
<span id="cb12-71"><a href="#cb12-71" tabindex="-1"></a><span class="co">#&gt; 4               1993-05-01     2025-02-14T00:00:00Z</span></span>
<span id="cb12-72"><a href="#cb12-72" tabindex="-1"></a><span class="co">#&gt;                         geometry</span></span>
<span id="cb12-73"><a href="#cb12-73" tabindex="-1"></a><span class="co">#&gt; 1 POLYGON ((-3.970308 55.7425...</span></span>
<span id="cb12-74"><a href="#cb12-74" tabindex="-1"></a><span class="co">#&gt; 2 POLYGON ((1.727559 52.66142...</span></span>
<span id="cb12-75"><a href="#cb12-75" tabindex="-1"></a><span class="co">#&gt; 3 POLYGON ((0.1941514 51.5924...</span></span>
<span id="cb12-76"><a href="#cb12-76" tabindex="-1"></a><span class="co">#&gt; 4 POLYGON ((-1.454721 52.3961...</span></span></code></pre></div>
</div>
</div>
<div id="adding-filters" class="section level2">
<h2>4. Adding Filters</h2>
<p>Filters can help you limit the scope of your query using spatial,
temporal and contextual parameters. The NGD Features API uses Common
Query Language (CQL) to allow you to filter data using the attribution
set of each collection.</p>
<ul>
<li>Spatial: <code>extent</code></li>
</ul>
<p>You can specify any polygon to query by using the functions in
<code>osdatahub</code> to create extents. You can learn more about using
extents here.</p>
<ul>
<li>Temporal: <code>state_datetime</code> and
<code>end_datetime</code></li>
</ul>
<p>If you want to only get features that have a temporal property, you
can specify date ranges to query within. If youw ant to get features for
a single time, simply provide the same argument for both parameters.</p>
<ul>
<li>Contextual: <code>cql_filter</code></li>
</ul>
<p>The NGD API supports a generic filter grammar called the Common Query
Language (CQL) to further filter your query using human readable
commands. You can find out more about the operations that the API
supports in the Queryables section of the <a href="https://osdatahub.os.uk/docs/ofa/technicalSpecification">Technical
Specification</a>. The CQL filter allows you to specify specific
properties for features as well as spatial filters.</p>
<p>In addition, the <code>osdatahub</code> package permits you to
specify the maximum number of features to return (by default, 100
features):</p>
<ul>
<li><code>max_results</code></li>
</ul>
<p>Allows you to specify the maximum number of features you’d like to
receive. Default is 100.</p>
<ul>
<li><code>offset</code></li>
</ul>
<p>Skips past the specified number of features in the collection.
Default is 0.</p>
<div id="specifying-an-extent-bounding-box" class="section level3">
<h3>Specifying an Extent (Bounding Box)</h3>
<p>In our case, we want to get features that are only within a certain
bounding box in Manchester. We can specify an extent based on the
geometry, and then pass this into the query:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>extent <span class="ot">=</span> <span class="fu">extent_from_bbox</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.244973</span>, <span class="fl">53.476620</span>, <span class="sc">-</span><span class="fl">2.237799</span>, <span class="fl">53.480525</span>),</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>                          <span class="at">crs =</span> <span class="st">&#39;CRS84&#39;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># Specify the &#39;extent&#39; as the first parameter to define the type of query.</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>features <span class="ot">=</span> <span class="fu">query_ngd</span>(<span class="at">x =</span> extent,</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>                     <span class="at">collection =</span> collection,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>                     <span class="at">max_results =</span> <span class="dv">4</span>,</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>                     <span class="at">returnType =</span> <span class="st">&#39;sf&#39;</span>)</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co"># run this cell to see the contents of &#39;features&#39;</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>features</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 4 features and 39 fields</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -2.242056 ymin: 53.47747 xmax: -2.239881 ymax: 53.48008</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co">#&gt;                                   osid              toid     theme</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt; 1 02837688-4553-4d32-87aa-10733dad9274 osgb1000024157902 Buildings</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co">#&gt; 2 02c6f2c7-0e25-4224-b4a7-c62c7d476e48 osgb1000024157913 Buildings</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co">#&gt; 3 0364fa8b-024a-4078-ae13-4a3e21c5e744 osgb1000024155721 Buildings</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="co">#&gt; 4 050aaf7a-2fd2-43f8-a8cf-7594b3b85059 osgb1000024155885 Buildings</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co">#&gt;            changetype isobscured description versiondate geometry_area</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="co">#&gt; 1 Modified Attributes      FALSE    Building  2025-02-17      21.57975</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="co">#&gt; 2 Modified Attributes      FALSE    Building  2025-02-17     441.13125</span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="co">#&gt; 3 Modified Attributes      FALSE    Building  2025-02-17     173.96250</span></span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="co">#&gt; 4 Modified Attributes      FALSE    Building  2023-06-03       2.99890</span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="co">#&gt;     height_source physicallevel               oslandusetiera</span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="co">#&gt; 1 Ordnance Survey Surface Level Unknown Or Unused Artificial</span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="co">#&gt; 2 Ordnance Survey Surface Level  Commercial Activity: Retail</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a><span class="co">#&gt; 3 Ordnance Survey Surface Level Unknown Or Unused Artificial</span></span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a><span class="co">#&gt; 4            &lt;NA&gt; Surface Level    Residential Accommodation</span></span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a><span class="co">#&gt;          oslandusetierb geometry_source oslandcovertiera oslandcovertierb</span></span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a><span class="co">#&gt; 1                    [] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a><span class="co">#&gt; 2                    [] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a><span class="co">#&gt; 3                    [] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a><span class="co">#&gt; 4 [&quot;Private Residence&quot;] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a><span class="co">#&gt;   oslanduse_source height_updatedate description_source oslandcover_source</span></span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a><span class="co">#&gt; 1  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a><span class="co">#&gt; 2  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a><span class="co">#&gt; 3  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a><span class="co">#&gt; 4  Ordnance Survey              &lt;NA&gt;    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a><span class="co">#&gt;   associatedstructure geometry_updatedate height_evidencedate</span></span>
<span id="cb13-43"><a href="#cb13-43" tabindex="-1"></a><span class="co">#&gt; 1                &lt;NA&gt;          2016-10-26          2023-06-09</span></span>
<span id="cb13-44"><a href="#cb13-44" tabindex="-1"></a><span class="co">#&gt; 2                &lt;NA&gt;          2010-04-13          2023-06-09</span></span>
<span id="cb13-45"><a href="#cb13-45" tabindex="-1"></a><span class="co">#&gt; 3                &lt;NA&gt;          1993-05-01          2023-06-09</span></span>
<span id="cb13-46"><a href="#cb13-46" tabindex="-1"></a><span class="co">#&gt; 4                &lt;NA&gt;          1998-12-09                &lt;NA&gt;</span></span>
<span id="cb13-47"><a href="#cb13-47" tabindex="-1"></a><span class="co">#&gt;   capturespecification oslanduse_updatedate absoluteheightmaximum</span></span>
<span id="cb13-48"><a href="#cb13-48" tabindex="-1"></a><span class="co">#&gt; 1                Urban           1993-05-01                  68.8</span></span>
<span id="cb13-49"><a href="#cb13-49" tabindex="-1"></a><span class="co">#&gt; 2                Urban           2010-04-13                  68.1</span></span>
<span id="cb13-50"><a href="#cb13-50" tabindex="-1"></a><span class="co">#&gt; 3                Urban           1993-05-01                  57.5</span></span>
<span id="cb13-51"><a href="#cb13-51" tabindex="-1"></a><span class="co">#&gt; 4                Urban           1998-12-09                    NA</span></span>
<span id="cb13-52"><a href="#cb13-52" tabindex="-1"></a><span class="co">#&gt;   absoluteheightminimum geometry_evidencedate heightconfidencelevel</span></span>
<span id="cb13-53"><a href="#cb13-53" tabindex="-1"></a><span class="co">#&gt; 1                  43.4            2016-10-04              Moderate</span></span>
<span id="cb13-54"><a href="#cb13-54" tabindex="-1"></a><span class="co">#&gt; 2                  44.2            2010-04-13              Moderate</span></span>
<span id="cb13-55"><a href="#cb13-55" tabindex="-1"></a><span class="co">#&gt; 3                  42.2            1993-05-01              Moderate</span></span>
<span id="cb13-56"><a href="#cb13-56" tabindex="-1"></a><span class="co">#&gt; 4                    NA            1998-12-09                  &lt;NA&gt;</span></span>
<span id="cb13-57"><a href="#cb13-57" tabindex="-1"></a><span class="co">#&gt;   relativeheightmaximum absoluteheightroofbase description_updatedate</span></span>
<span id="cb13-58"><a href="#cb13-58" tabindex="-1"></a><span class="co">#&gt; 1                  25.4                   66.8             1993-05-01</span></span>
<span id="cb13-59"><a href="#cb13-59" tabindex="-1"></a><span class="co">#&gt; 2                  23.9                   60.9             2010-04-13</span></span>
<span id="cb13-60"><a href="#cb13-60" tabindex="-1"></a><span class="co">#&gt; 3                  15.3                   52.9             1993-05-01</span></span>
<span id="cb13-61"><a href="#cb13-61" tabindex="-1"></a><span class="co">#&gt; 4                    NA                     NA             1998-12-09</span></span>
<span id="cb13-62"><a href="#cb13-62" tabindex="-1"></a><span class="co">#&gt;   oslandcover_updatedate oslanduse_evidencedate relativeheightroofbase</span></span>
<span id="cb13-63"><a href="#cb13-63" tabindex="-1"></a><span class="co">#&gt; 1             1993-05-01             1993-05-01                   23.4</span></span>
<span id="cb13-64"><a href="#cb13-64" tabindex="-1"></a><span class="co">#&gt; 2             2010-04-13             2010-04-13                   16.7</span></span>
<span id="cb13-65"><a href="#cb13-65" tabindex="-1"></a><span class="co">#&gt; 3             1993-05-01             1993-05-01                   10.7</span></span>
<span id="cb13-66"><a href="#cb13-66" tabindex="-1"></a><span class="co">#&gt; 4             1998-12-09             1998-12-09                     NA</span></span>
<span id="cb13-67"><a href="#cb13-67" tabindex="-1"></a><span class="co">#&gt;   versionavailabletodate firstdigitalcapturedate description_evidencedate</span></span>
<span id="cb13-68"><a href="#cb13-68" tabindex="-1"></a><span class="co">#&gt; 1                   &lt;NA&gt;              1993-05-01               1993-05-01</span></span>
<span id="cb13-69"><a href="#cb13-69" tabindex="-1"></a><span class="co">#&gt; 2                   &lt;NA&gt;              1993-05-01               2010-04-13</span></span>
<span id="cb13-70"><a href="#cb13-70" tabindex="-1"></a><span class="co">#&gt; 3                   &lt;NA&gt;              1993-05-01               1993-05-01</span></span>
<span id="cb13-71"><a href="#cb13-71" tabindex="-1"></a><span class="co">#&gt; 4                   &lt;NA&gt;              1998-12-09               1998-12-09</span></span>
<span id="cb13-72"><a href="#cb13-72" tabindex="-1"></a><span class="co">#&gt;   oslandcover_evidencedate versionavailablefromdate</span></span>
<span id="cb13-73"><a href="#cb13-73" tabindex="-1"></a><span class="co">#&gt; 1               1993-05-01     2025-02-18T00:00:00Z</span></span>
<span id="cb13-74"><a href="#cb13-74" tabindex="-1"></a><span class="co">#&gt; 2               2010-04-13     2025-02-18T00:00:00Z</span></span>
<span id="cb13-75"><a href="#cb13-75" tabindex="-1"></a><span class="co">#&gt; 3               1993-05-01     2025-02-18T00:00:00Z</span></span>
<span id="cb13-76"><a href="#cb13-76" tabindex="-1"></a><span class="co">#&gt; 4               1998-12-09     2023-06-04T00:00:00Z</span></span>
<span id="cb13-77"><a href="#cb13-77" tabindex="-1"></a><span class="co">#&gt;                         geometry</span></span>
<span id="cb13-78"><a href="#cb13-78" tabindex="-1"></a><span class="co">#&gt; 1 POLYGON ((-2.240982 53.4790...</span></span>
<span id="cb13-79"><a href="#cb13-79" tabindex="-1"></a><span class="co">#&gt; 2 POLYGON ((-2.241351 53.4798...</span></span>
<span id="cb13-80"><a href="#cb13-80" tabindex="-1"></a><span class="co">#&gt; 3 POLYGON ((-2.240074 53.4781...</span></span>
<span id="cb13-81"><a href="#cb13-81" tabindex="-1"></a><span class="co">#&gt; 4 POLYGON ((-2.242056 53.4774...</span></span></code></pre></div>
</div>
<div id="custom-paging-parameters" class="section level3">
<h3>Custom Paging Parameters</h3>
<p>By default, <code>osdatahub</code> will return a maximum 100 features
to a query - starting at zero. This behaviour can be altered by
specifying <code>max_results</code> and <code>offset</code> parameters.
<em>We’ll be building on the previous example, specifying the same
extent as before…</em></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># returns a maximum of 4 results (features 1 to 4)</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>features <span class="ot">=</span> <span class="fu">query_ngd</span>(extent,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                     <span class="at">collection =</span> collection,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                     <span class="at">max_results =</span> <span class="dv">4</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co"># returns a maximum of 4 results (features 101 to 104)</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>features <span class="ot">=</span> <span class="fu">query_ngd</span>(extent,</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>                     <span class="at">collection =</span> collection,</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>                     <span class="at">offset =</span> <span class="dv">100</span>,</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>                     <span class="at">max_results =</span> <span class="dv">4</span>,</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>                     <span class="at">returnType =</span> <span class="st">&#39;sf&#39;</span>)</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co"># run this cell to see the contents of &#39;features&#39;</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>features</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 4 features and 39 fields</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -2.2437 ymin: 53.47778 xmax: -2.238997 ymax: 53.48001</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt;                                   osid                 toid     theme</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; 1 52335576-4e7b-47f8-ab79-a644172032f0    osgb1000024155700 Buildings</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; 2 537d6ba9-5902-4e6b-b193-ad604a1570b9 osgb1000002517038005 Buildings</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; 3 57450ef6-1c0e-468b-8f41-29f3b91e9e1c    osgb1000024155761 Buildings</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt; 4 576e3927-9673-4fd2-87cc-e18b84da1f3b osgb5000005289320947 Buildings</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt;            changetype isobscured description versiondate geometry_area</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt; 1 Modified Attributes      FALSE    Building  2025-02-17     166.62625</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt; 2 Modified Attributes      FALSE    Building  2025-02-17    1018.93900</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="co">#&gt; 3 Modified Attributes      FALSE    Building  2025-02-17     105.23000</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="co">#&gt; 4 Modified Attributes      FALSE    Building  2025-02-17      13.84195</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt;     height_source physicallevel               oslandusetiera oslandusetierb</span></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="co">#&gt; 1 Ordnance Survey Surface Level Unknown Or Unused Artificial             []</span></span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a><span class="co">#&gt; 2 Ordnance Survey Surface Level Unknown Or Unused Artificial             []</span></span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="co">#&gt; 3 Ordnance Survey Surface Level Unknown Or Unused Artificial             []</span></span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a><span class="co">#&gt; 4 Ordnance Survey Surface Level                    Mixed Use             []</span></span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="co">#&gt;   geometry_source oslandcovertiera oslandcovertierb oslanduse_source</span></span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a><span class="co">#&gt; 1 Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey</span></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="co">#&gt; 2 Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey</span></span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a><span class="co">#&gt; 3 Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey</span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a><span class="co">#&gt; 4 Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey</span></span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a><span class="co">#&gt;   height_updatedate description_source oslandcover_source associatedstructure</span></span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a><span class="co">#&gt; 1        2025-01-17    Ordnance Survey    Ordnance Survey                &lt;NA&gt;</span></span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a><span class="co">#&gt; 2        2025-01-17    Ordnance Survey    Ordnance Survey                &lt;NA&gt;</span></span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a><span class="co">#&gt; 3        2025-01-17    Ordnance Survey    Ordnance Survey                &lt;NA&gt;</span></span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a><span class="co">#&gt; 4        2025-01-17    Ordnance Survey    Ordnance Survey                &lt;NA&gt;</span></span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a><span class="co">#&gt;   geometry_updatedate height_evidencedate capturespecification</span></span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a><span class="co">#&gt; 1          2010-04-28          2023-06-09                Urban</span></span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a><span class="co">#&gt; 2          2007-03-22          2023-06-09                Urban</span></span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a><span class="co">#&gt; 3          2010-04-26          2023-06-09                Urban</span></span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a><span class="co">#&gt; 4          2021-11-15          2023-06-09                Urban</span></span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a><span class="co">#&gt;   oslanduse_updatedate absoluteheightmaximum absoluteheightminimum</span></span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a><span class="co">#&gt; 1           2010-04-28                  63.8                  42.6</span></span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a><span class="co">#&gt; 2           2007-03-22                  70.5                  41.4</span></span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a><span class="co">#&gt; 3           2010-04-26                  63.3                  41.3</span></span>
<span id="cb14-54"><a href="#cb14-54" tabindex="-1"></a><span class="co">#&gt; 4           2021-11-15                    NA                  45.1</span></span>
<span id="cb14-55"><a href="#cb14-55" tabindex="-1"></a><span class="co">#&gt;   geometry_evidencedate heightconfidencelevel relativeheightmaximum</span></span>
<span id="cb14-56"><a href="#cb14-56" tabindex="-1"></a><span class="co">#&gt; 1            2010-04-28              Moderate                  21.2</span></span>
<span id="cb14-57"><a href="#cb14-57" tabindex="-1"></a><span class="co">#&gt; 2            2007-03-22              Moderate                  29.1</span></span>
<span id="cb14-58"><a href="#cb14-58" tabindex="-1"></a><span class="co">#&gt; 3            2010-04-26              Moderate                  22.0</span></span>
<span id="cb14-59"><a href="#cb14-59" tabindex="-1"></a><span class="co">#&gt; 4            2021-04-19            Incomplete                    NA</span></span>
<span id="cb14-60"><a href="#cb14-60" tabindex="-1"></a><span class="co">#&gt;   absoluteheightroofbase description_updatedate oslandcover_updatedate</span></span>
<span id="cb14-61"><a href="#cb14-61" tabindex="-1"></a><span class="co">#&gt; 1                   61.3             2010-04-28             2010-04-28</span></span>
<span id="cb14-62"><a href="#cb14-62" tabindex="-1"></a><span class="co">#&gt; 2                   66.2             2007-03-22             2007-03-22</span></span>
<span id="cb14-63"><a href="#cb14-63" tabindex="-1"></a><span class="co">#&gt; 3                   60.7             2010-04-26             2010-04-26</span></span>
<span id="cb14-64"><a href="#cb14-64" tabindex="-1"></a><span class="co">#&gt; 4                     NA             2021-11-15             2021-11-15</span></span>
<span id="cb14-65"><a href="#cb14-65" tabindex="-1"></a><span class="co">#&gt;   oslanduse_evidencedate relativeheightroofbase versionavailabletodate</span></span>
<span id="cb14-66"><a href="#cb14-66" tabindex="-1"></a><span class="co">#&gt; 1             2010-04-28                   18.7                   &lt;NA&gt;</span></span>
<span id="cb14-67"><a href="#cb14-67" tabindex="-1"></a><span class="co">#&gt; 2             2007-03-22                   24.8                   &lt;NA&gt;</span></span>
<span id="cb14-68"><a href="#cb14-68" tabindex="-1"></a><span class="co">#&gt; 3             2010-04-26                   19.4                   &lt;NA&gt;</span></span>
<span id="cb14-69"><a href="#cb14-69" tabindex="-1"></a><span class="co">#&gt; 4             2021-04-19                     NA                   &lt;NA&gt;</span></span>
<span id="cb14-70"><a href="#cb14-70" tabindex="-1"></a><span class="co">#&gt;   firstdigitalcapturedate description_evidencedate oslandcover_evidencedate</span></span>
<span id="cb14-71"><a href="#cb14-71" tabindex="-1"></a><span class="co">#&gt; 1              1993-05-01               2010-04-28               2010-04-28</span></span>
<span id="cb14-72"><a href="#cb14-72" tabindex="-1"></a><span class="co">#&gt; 2              2007-03-22               2007-03-22               2007-03-22</span></span>
<span id="cb14-73"><a href="#cb14-73" tabindex="-1"></a><span class="co">#&gt; 3              1993-05-01               2010-04-26               2010-04-26</span></span>
<span id="cb14-74"><a href="#cb14-74" tabindex="-1"></a><span class="co">#&gt; 4              2021-11-15               2021-04-19               2021-04-19</span></span>
<span id="cb14-75"><a href="#cb14-75" tabindex="-1"></a><span class="co">#&gt;   versionavailablefromdate                       geometry</span></span>
<span id="cb14-76"><a href="#cb14-76" tabindex="-1"></a><span class="co">#&gt; 1     2025-02-18T00:00:00Z POLYGON ((-2.238997 53.4783...</span></span>
<span id="cb14-77"><a href="#cb14-77" tabindex="-1"></a><span class="co">#&gt; 2     2025-02-18T00:00:00Z POLYGON ((-2.243258 53.4794...</span></span>
<span id="cb14-78"><a href="#cb14-78" tabindex="-1"></a><span class="co">#&gt; 3     2025-02-18T00:00:00Z POLYGON ((-2.241665 53.4779...</span></span>
<span id="cb14-79"><a href="#cb14-79" tabindex="-1"></a><span class="co">#&gt; 4     2025-02-18T00:00:00Z POLYGON ((-2.239085 53.4799...</span></span></code></pre></div>
</div>
<div id="applying-cql-filters" class="section level3">
<h3>Applying CQL Filters</h3>
<p>Common Query Language (CQL) filters are a handy way in which you can
tailor the results of your query to match specific needs. More
information on CQL filters can be found <a href="https://labs.os.uk/public/osngd/os-ngd-api-features/">here</a>. We
can pass a filter in the API using the <code>filter</code>
parameter.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Building off the same extent covering Manchester, filtering by buildings</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co"># larger than or equal to 20m^2 and with a maximum height greater than 60m.</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co"># At the time of writing, this returns 7 features (buildings)</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>features <span class="ot">=</span> <span class="fu">query_ngd</span>(extent,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>                     <span class="at">collection =</span> collection,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>                     <span class="at">cql_filter=</span><span class="st">&#39;geometry_area&gt;=200 AND relativeheightmaximum&gt;60&#39;</span>,</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>                     <span class="at">returnType =</span> <span class="st">&#39;sf&#39;</span>)</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co"># run this cell to see the contents of &#39;features&#39;</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>features</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 5 features and 39 fields</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -2.243429 ymin: 53.47677 xmax: -2.237916 ymax: 53.48042</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt;                                   osid                 toid     theme</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; 1 40fa2462-4c01-48d4-bcf1-5179efb56027 osgb5000005134737612 Buildings</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; 2 41ab80d3-28ca-460f-9afe-04671aa2807a osgb1000002517080496 Buildings</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; 3 8ce5ac53-d4ee-492d-9b6d-56b069252cbe    osgb1000024155687 Buildings</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; 4 af43ce9a-18d2-47d2-9744-fdc89f7c241c osgb5000005267089134 Buildings</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; 5 cfe4934e-8360-40bb-81eb-5f49d240c2b8 osgb5000005275364197 Buildings</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt;            changetype isobscured description versiondate geometry_area</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; 1 Modified Attributes      FALSE    Building  2025-02-17     2122.6936</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt; 2 Modified Attributes      FALSE    Building  2025-02-17      687.8187</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co">#&gt; 3 Modified Attributes      FALSE    Building  2025-02-17      748.8005</span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a><span class="co">#&gt; 4 Modified Attributes      FALSE    Building  2025-02-17     1590.4881</span></span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a><span class="co">#&gt; 5 Modified Attributes      FALSE    Building  2025-02-17     1143.7811</span></span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a><span class="co">#&gt;     height_source physicallevel                                   oslandusetiera</span></span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a><span class="co">#&gt; 1 Ordnance Survey Surface Level                                        Mixed Use</span></span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a><span class="co">#&gt; 2 Ordnance Survey Surface Level Commercial Activity: Industrial Or Manufacturing</span></span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a><span class="co">#&gt; 3 Ordnance Survey Surface Level                                        Mixed Use</span></span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a><span class="co">#&gt; 4 Ordnance Survey Surface Level Commercial Activity: Industrial Or Manufacturing</span></span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a><span class="co">#&gt; 5 Ordnance Survey Surface Level               Temporary Or Holiday Accommodation</span></span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a><span class="co">#&gt;   oslandusetierb geometry_source oslandcovertiera oslandcovertierb</span></span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a><span class="co">#&gt; 1             [] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a><span class="co">#&gt; 2             [] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a><span class="co">#&gt; 3             [] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a><span class="co">#&gt; 4             [] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a><span class="co">#&gt; 5             [] Ordnance Survey      Constructed     [&quot;Building&quot;]</span></span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a><span class="co">#&gt;   oslanduse_source height_updatedate description_source oslandcover_source</span></span>
<span id="cb15-43"><a href="#cb15-43" tabindex="-1"></a><span class="co">#&gt; 1  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb15-44"><a href="#cb15-44" tabindex="-1"></a><span class="co">#&gt; 2  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb15-45"><a href="#cb15-45" tabindex="-1"></a><span class="co">#&gt; 3  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb15-46"><a href="#cb15-46" tabindex="-1"></a><span class="co">#&gt; 4  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb15-47"><a href="#cb15-47" tabindex="-1"></a><span class="co">#&gt; 5  Ordnance Survey        2025-01-17    Ordnance Survey    Ordnance Survey</span></span>
<span id="cb15-48"><a href="#cb15-48" tabindex="-1"></a><span class="co">#&gt;   associatedstructure geometry_updatedate height_evidencedate</span></span>
<span id="cb15-49"><a href="#cb15-49" tabindex="-1"></a><span class="co">#&gt; 1                &lt;NA&gt;          2017-09-26          2023-06-09</span></span>
<span id="cb15-50"><a href="#cb15-50" tabindex="-1"></a><span class="co">#&gt; 2                &lt;NA&gt;          2009-06-25          2023-06-09</span></span>
<span id="cb15-51"><a href="#cb15-51" tabindex="-1"></a><span class="co">#&gt; 3                &lt;NA&gt;          2024-06-25          2023-06-09</span></span>
<span id="cb15-52"><a href="#cb15-52" tabindex="-1"></a><span class="co">#&gt; 4                &lt;NA&gt;          2020-07-16          2023-06-09</span></span>
<span id="cb15-53"><a href="#cb15-53" tabindex="-1"></a><span class="co">#&gt; 5                &lt;NA&gt;          2021-01-13          2023-06-09</span></span>
<span id="cb15-54"><a href="#cb15-54" tabindex="-1"></a><span class="co">#&gt;   capturespecification oslanduse_updatedate absoluteheightmaximum</span></span>
<span id="cb15-55"><a href="#cb15-55" tabindex="-1"></a><span class="co">#&gt; 1                Urban           2014-09-26                 102.5</span></span>
<span id="cb15-56"><a href="#cb15-56" tabindex="-1"></a><span class="co">#&gt; 2                Urban           2009-06-25                 105.4</span></span>
<span id="cb15-57"><a href="#cb15-57" tabindex="-1"></a><span class="co">#&gt; 3                Urban           2010-03-18                 117.3</span></span>
<span id="cb15-58"><a href="#cb15-58" tabindex="-1"></a><span class="co">#&gt; 4                Urban           2020-07-16                 102.9</span></span>
<span id="cb15-59"><a href="#cb15-59" tabindex="-1"></a><span class="co">#&gt; 5                Urban           2021-01-13                 112.1</span></span>
<span id="cb15-60"><a href="#cb15-60" tabindex="-1"></a><span class="co">#&gt;   absoluteheightminimum geometry_evidencedate heightconfidencelevel</span></span>
<span id="cb15-61"><a href="#cb15-61" tabindex="-1"></a><span class="co">#&gt; 1                  38.7            2017-09-26              Moderate</span></span>
<span id="cb15-62"><a href="#cb15-62" tabindex="-1"></a><span class="co">#&gt; 2                  43.2            2009-06-25              Moderate</span></span>
<span id="cb15-63"><a href="#cb15-63" tabindex="-1"></a><span class="co">#&gt; 3                  43.1            2023-05-20              Moderate</span></span>
<span id="cb15-64"><a href="#cb15-64" tabindex="-1"></a><span class="co">#&gt; 4                  38.7            2020-07-16              Moderate</span></span>
<span id="cb15-65"><a href="#cb15-65" tabindex="-1"></a><span class="co">#&gt; 5                  40.2            2021-01-13              Moderate</span></span>
<span id="cb15-66"><a href="#cb15-66" tabindex="-1"></a><span class="co">#&gt;   relativeheightmaximum absoluteheightroofbase description_updatedate</span></span>
<span id="cb15-67"><a href="#cb15-67" tabindex="-1"></a><span class="co">#&gt; 1                  63.8                   95.9             2014-09-26</span></span>
<span id="cb15-68"><a href="#cb15-68" tabindex="-1"></a><span class="co">#&gt; 2                  62.2                   99.5             2009-06-25</span></span>
<span id="cb15-69"><a href="#cb15-69" tabindex="-1"></a><span class="co">#&gt; 3                  74.2                  104.3             2010-03-18</span></span>
<span id="cb15-70"><a href="#cb15-70" tabindex="-1"></a><span class="co">#&gt; 4                  64.2                   97.3             2020-07-16</span></span>
<span id="cb15-71"><a href="#cb15-71" tabindex="-1"></a><span class="co">#&gt; 5                  71.9                  107.6             2021-01-13</span></span>
<span id="cb15-72"><a href="#cb15-72" tabindex="-1"></a><span class="co">#&gt;   oslandcover_updatedate oslanduse_evidencedate relativeheightroofbase</span></span>
<span id="cb15-73"><a href="#cb15-73" tabindex="-1"></a><span class="co">#&gt; 1             2014-09-26             2013-11-04                   57.2</span></span>
<span id="cb15-74"><a href="#cb15-74" tabindex="-1"></a><span class="co">#&gt; 2             2009-06-25             2009-06-25                   56.3</span></span>
<span id="cb15-75"><a href="#cb15-75" tabindex="-1"></a><span class="co">#&gt; 3             2010-03-18             2010-03-18                   61.2</span></span>
<span id="cb15-76"><a href="#cb15-76" tabindex="-1"></a><span class="co">#&gt; 4             2020-07-16             2020-07-16                   58.6</span></span>
<span id="cb15-77"><a href="#cb15-77" tabindex="-1"></a><span class="co">#&gt; 5             2021-01-13             2021-01-13                   67.4</span></span>
<span id="cb15-78"><a href="#cb15-78" tabindex="-1"></a><span class="co">#&gt;   versionavailabletodate firstdigitalcapturedate description_evidencedate</span></span>
<span id="cb15-79"><a href="#cb15-79" tabindex="-1"></a><span class="co">#&gt; 1                   &lt;NA&gt;              2014-10-21               2013-11-04</span></span>
<span id="cb15-80"><a href="#cb15-80" tabindex="-1"></a><span class="co">#&gt; 2                   &lt;NA&gt;              2009-06-25               2009-06-25</span></span>
<span id="cb15-81"><a href="#cb15-81" tabindex="-1"></a><span class="co">#&gt; 3                   &lt;NA&gt;              1993-05-01               2010-03-18</span></span>
<span id="cb15-82"><a href="#cb15-82" tabindex="-1"></a><span class="co">#&gt; 4                   &lt;NA&gt;              2020-07-16               2020-07-16</span></span>
<span id="cb15-83"><a href="#cb15-83" tabindex="-1"></a><span class="co">#&gt; 5                   &lt;NA&gt;              2021-01-13               2021-01-13</span></span>
<span id="cb15-84"><a href="#cb15-84" tabindex="-1"></a><span class="co">#&gt;   oslandcover_evidencedate versionavailablefromdate</span></span>
<span id="cb15-85"><a href="#cb15-85" tabindex="-1"></a><span class="co">#&gt; 1               2013-11-04     2025-02-18T00:00:00Z</span></span>
<span id="cb15-86"><a href="#cb15-86" tabindex="-1"></a><span class="co">#&gt; 2               2009-06-25     2025-02-18T00:00:00Z</span></span>
<span id="cb15-87"><a href="#cb15-87" tabindex="-1"></a><span class="co">#&gt; 3               2010-03-18     2025-02-18T00:00:00Z</span></span>
<span id="cb15-88"><a href="#cb15-88" tabindex="-1"></a><span class="co">#&gt; 4               2020-07-16     2025-02-18T00:00:00Z</span></span>
<span id="cb15-89"><a href="#cb15-89" tabindex="-1"></a><span class="co">#&gt; 5               2021-01-13     2025-02-18T00:00:00Z</span></span>
<span id="cb15-90"><a href="#cb15-90" tabindex="-1"></a><span class="co">#&gt;                         geometry</span></span>
<span id="cb15-91"><a href="#cb15-91" tabindex="-1"></a><span class="co">#&gt; 1 POLYGON ((-2.242897 53.4772...</span></span>
<span id="cb15-92"><a href="#cb15-92" tabindex="-1"></a><span class="co">#&gt; 2 POLYGON ((-2.242983 53.4804...</span></span>
<span id="cb15-93"><a href="#cb15-93" tabindex="-1"></a><span class="co">#&gt; 3 POLYGON ((-2.238278 53.4780...</span></span>
<span id="cb15-94"><a href="#cb15-94" tabindex="-1"></a><span class="co">#&gt; 4 POLYGON ((-2.2422 53.47719,...</span></span>
<span id="cb15-95"><a href="#cb15-95" tabindex="-1"></a><span class="co">#&gt; 5 POLYGON ((-2.241926 53.4779...</span></span></code></pre></div>
</div>
</div>
<div id="conclusion" class="section level2">
<h2>5. Conclusion</h2>
<p>We hope this short introduction to the <code>osdatahub</code>
package’s new NGD capabilities has been useful! You can find further
resources to assist you on your OS API development journal at: <a href="https://docs.os.uk/os-apis">https://docs.os.uk/os-apis</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
