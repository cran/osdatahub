<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Using the NGD Features API with R</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Using the NGD Features API with R</h1>



<p>The National Geographic Database (NGD) Features API provides access
to Ordnance Survey’s next generation NGD data. The NGD Features API is a
premium or public sector product only. The <a href="https://www.ordnancesurvey.co.uk/business-government/products/os-ngd-api-features">NGD
Features API</a> allows for programmatic access to NGD data in
<code>GeoJSON</code> format. For <code>R</code> developers,
<code>osdatahub</code> library wraps the functionality of the NGD
Features API to make it easy to get data from Ordnance Survey.</p>
<blockquote>
<p>Not using <code>R</code>? There are <a href="https://github.com/OrdnanceSurvey/osdatahub">Python</a> and <a href="https://github.com/OrdnanceSurvey/osdatahub-js">JavaScript</a>
versions of <code>osdatahub</code>.</p>
</blockquote>
<div id="getting-started" class="section level2">
<h2>1. Getting Started</h2>
<div id="importing-the-osdatahub-package" class="section level3">
<h3>Importing the <code>osdatahub</code> package</h3>
<p>Once the package is installed within <code>R</code>, import the
library.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(osdatahub)</span></code></pre></div>
</div>
<div id="importing-your-os-data-hub-api-key" class="section level3">
<h3>Importing your OS Data Hub API Key</h3>
<p>In order to access the NGD, you must first have an OS Data Hub API
key. A notebook explaining the process of registering an account and
getting an API key is available to read <a href="https://github.com/OrdnanceSurvey/osdatahub/blob/master/Examples/Setting%20up%20an%20API%20key.ipynb">here</a>.
When you’re choosing which APIs you want to add to your project, you
must select “OS NGD API - Features” to use NGD data.</p>
<p>Once you have an API key, you can load your API key in by either
passing it in as a string to functions in <code>osdatahub</code>, or
setting it as an environment variable. While you can store your API key
as a string variable in your scripts, you want to protect your API key
and not share it with others.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 1.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an environment variable with your API key.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This function is available in the osdatahub package.</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set_os_key</span>(<span class="st">&#39;YOUR API KEY HERE&#39;</span>)</span></code></pre></div>
<p>Alternatively, you can add the environment variable manually in a
file called <code>.Renviron</code>, typically in your home
directory.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 2.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter the following command in the R console.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">file.edit</span>(<span class="st">&quot;~/.Renviron&quot;</span>)</span></code></pre></div>
<p>The file looks something like:</p>
<pre><code>VAR1 = value1
VAR2 = value2</code></pre>
<p>Add a variable named: <code>OS_API_KEY</code>. Note that
<code>.Renviron</code> is processed on start-up, so restart
<code>R</code> to see changes. Environment variables are available in
every running R process, and can be read by any other program on your
computer. More secure options see the <a href="https://keyring.r-lib.org/index.html"><code>keyring</code>
package</a>.</p>
</div>
<div id="import-the-osdatahub-package" class="section level3">
<h3>Import the <code>osdatahub</code> package</h3>
<p>To access the NGD API functions from <code>osdatahub</code>, write
the following:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(osdatahub)</span></code></pre></div>
</div>
</div>
<div id="discovering-collections" class="section level2">
<h2>2. Discovering Collections</h2>
<p>The NGD contains multiple themes and collections:</p>
<ul>
<li>A <code>theme</code> is a family of <code>collections</code>, for
example, there is a theme called ‘Buildings’.</li>
<li>A <code>collection</code> is a group of features. The Buildings
theme contains two collections: ‘BuildingLine’ and ‘BuildingPart’.</li>
</ul>
<p>You can read more about the NGD Features API’s themes and collections
in the <a href="https://osdatahub.os.uk/docs/ofa/technicalSpecification">Technical
Specification</a>.</p>
<p>To quickly retrieve a data frame of available data, you can query the
API directly:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ngd_collections <span class="ot">&lt;-</span> <span class="fu">list_ngd_collections</span>(<span class="at">simple =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>This will returna a data.frame object, which we can then iterate
through to return metadata about each collection.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(ngd_collections)){</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  collection <span class="ot">&lt;-</span> ngd_collections[i, ]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(collection<span class="sc">$</span>title, <span class="st">&#39;(&#39;</span>, collection<span class="sc">$</span>id, <span class="st">&#39;)&#39;</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Building v1(bld-fts-building-1)&quot;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Building Line v1(bld-fts-buildingline-1)&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Building Part v1(bld-fts-buildingpart-1)&quot;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Named Area v1(gnm-fts-namedarea-1)&quot;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Named Point v1(gnm-fts-namedpoint-1)&quot;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Land v1(lnd-fts-land-1)&quot;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Landform v1(lnd-fts-landform-1)&quot;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Landform Line v1(lnd-fts-landformline-1)&quot;</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Landform Point v1(lnd-fts-landformpoint-1)&quot;</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Land Point v1(lnd-fts-landpoint-1)&quot;</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Site v1(lus-fts-site-1)&quot;</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Site Access Location v1(lus-fts-siteaccesslocation-1)&quot;</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Site Routing Point v1(lus-fts-siteroutingpoint-1)&quot;</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Compound Structure v1(str-fts-compoundstructure-1)&quot;</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Structure v1(str-fts-structure-1)&quot;</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Structure Line v1(str-fts-structureline-1)&quot;</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Structure Point v1(str-fts-structurepoint-1)&quot;</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Cartographic Rail Detail v1(trn-fts-cartographicraildetail-1)&quot;</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Rail v1(trn-fts-rail-1)&quot;</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Line v1(trn-fts-roadline-1)&quot;</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Track Or Path v1(trn-fts-roadtrackorpath-1)&quot;</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Connecting Link v1(trn-ntwk-connectinglink-1)&quot;</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Connecting Node v1(trn-ntwk-connectingnode-1)&quot;</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Ferry Link v1(trn-ntwk-ferrylink-1)&quot;</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Ferry Node v1(trn-ntwk-ferrynode-1)&quot;</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Ferry Terminal v1(trn-ntwk-ferryterminal-1)&quot;</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Path v1(trn-ntwk-path-1)&quot;</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Path Link v1(trn-ntwk-pathlink-1)&quot;</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Path Node v1(trn-ntwk-pathnode-1)&quot;</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Pavement Link v1(trn-ntwk-pavementlink-1)&quot;</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Railway Link v1(trn-ntwk-railwaylink-1)&quot;</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Railway Link Set v1(trn-ntwk-railwaylinkset-1)&quot;</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Railway Node v1(trn-ntwk-railwaynode-1)&quot;</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road v1(trn-ntwk-road-1)&quot;</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Junction v1(trn-ntwk-roadjunction-1)&quot;</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Link v1(trn-ntwk-roadlink-1)&quot;</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Link v2(trn-ntwk-roadlink-2)&quot;</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Road Node v1(trn-ntwk-roadnode-1)&quot;</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Street v1(trn-ntwk-street-1)&quot;</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Average And Indicative Speed v1(trn-rami-averageandindicativespeed-1)&quot;</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Highway Dedication v1(trn-rami-highwaydedication-1)&quot;</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Maintenance Area v1(trn-rami-maintenancearea-1)&quot;</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Maintenance Line v1(trn-rami-maintenanceline-1)&quot;</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Maintenance Point v1(trn-rami-maintenancepoint-1)&quot;</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Reinstatement Area v1(trn-rami-reinstatementarea-1)&quot;</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Reinstatement Line v1(trn-rami-reinstatementline-1)&quot;</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Reinstatement Point v1(trn-rami-reinstatementpoint-1)&quot;</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Restriction v1(trn-rami-restriction-1)&quot;</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Routing Hazard v1(trn-rami-routinghazard-1)&quot;</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;RoutingStructure v1(trn-rami-routingstructure-1)&quot;</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Special Designation Area v1(trn-rami-specialdesignationarea-1)&quot;</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Special Designation Line v1(trn-rami-specialdesignationline-1)&quot;</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Special Designation Point v1(trn-rami-specialdesignationpoint-1)&quot;</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Inter Tidal Line v1(wtr-fts-intertidalline-1)&quot;</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Tidal Boundary v1(wtr-fts-tidalboundary-1)&quot;</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Water v1(wtr-fts-water-1)&quot;</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Water Point v1(wtr-fts-waterpoint-1)&quot;</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Water Link v1(wtr-ntwk-waterlink-1)&quot;</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Water Link Set v1(wtr-ntwk-waterlinkset-1)&quot;</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Water Node v1(wtr-ntwk-waternode-1)&quot;</span></span></code></pre></div>
</div>
<div id="loading-ngd-data-into-a-spatial-data-frame" class="section level2">
<h2>3. Loading NGD Data into a Spatial Data Frame</h2>
<p>We’ll now walk through the process of acquiring data from the NGD
Building Part collection (<code>bld-fts-buildingpart-1</code>) and
importing this data into a an object of type <code>sf</code>.</p>
<div id="requesting-ngd-data" class="section level3">
<h3>Requesting NGD Data</h3>
<p>To get the first 100 features in the collection, you simply need to
query use the NGD query function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>collection <span class="ot">&lt;-</span> <span class="st">&#39;bld-fts-buildingpart-1&#39;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># make the query and contact the API</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># reduce the number of features returned for the example</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>features <span class="ot">&lt;-</span> <span class="fu">query_ngd</span>(<span class="at">collection =</span> collection, <span class="at">max_results =</span> <span class="dv">4</span>)</span></code></pre></div>
<p>The API returns an OGC-compliant GeoJSON, which is easy to import
into other libraries for analysis.</p>
</div>
<div id="importing-into-a-spatial-data-frame" class="section level3">
<h3>Importing into a spatial data frame</h3>
<p>If you haven’t already, install and import the <code>sf</code>
library:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linking to GEOS 3.9.1, GDAL 3.3.2, PROJ 7.2.1; sf_use_s2() is TRUE</span></span></code></pre></div>
<p>And now, import the NGD data.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>gdf <span class="ot">=</span> <span class="fu">st_read</span>(features, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Let’s take a look at a preview of the data using <code>head()</code>.
As you’ll see, NGD data is rich in attribution:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gdf)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 4 features and 39 fields</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -3.97032 ymin: 51.59236 xmax: 1.727559 ymax: 55.7426</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   osid                 toid     theme          changetype isobscured description versiondate geometry_area   height_source</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 000000b1-0556-4231-a52a-9b5b8b82dfbf    osgb1000041024621 Buildings Modified Attributes      FALSE    Building  2022-09-18     59.200650 Ordnance Survey</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 00000183-3ae0-4f05-adb8-a5792d09f55f osgb5000005167584940 Buildings                 New      FALSE    Building  2022-08-26      9.499142 Ordnance Survey</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 000001d6-8217-4f7a-a70e-3757eb76c9e4    osgb1000000360448 Buildings                 New      FALSE    Building  2022-08-26     15.258750 Ordnance Survey</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 00000208-a659-49f9-a587-ab26cb2b2248    osgb1000017249389 Buildings                 New      FALSE    Building  2022-08-26     12.806250 Ordnance Survey</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   physicallevel               oslandusetiera        oslandusetierb geometry_source oslandcovertiera oslandcovertierb oslanduse_source height_updatedate</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Surface Level    Residential Accommodation [&quot;Private Residence&quot;] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey        2022-08-24</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Surface Level    Residential Accommodation [&quot;Private Residence&quot;] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey        2022-08-24</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Surface Level    Residential Accommodation [&quot;Private Residence&quot;] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey        2022-08-24</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Surface Level Unknown Or Unused Artificial                    [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey        2022-08-24</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   description_source oslandcover_source associatedstructure geometry_updatedate height_evidencedate capturespecification oslanduse_updatedate</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          2006-08-30          2022-06-20                Urban           2006-08-30</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          2015-10-29          2022-04-16                Rural           2015-10-29</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          1993-04-01          2022-07-10                Urban           1993-04-01</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          1993-05-01          2022-02-27                Urban           1993-05-01</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   absoluteheightmaximum absoluteheightminimum geometry_evidencedate heightconfidencelevel relativeheightmaximum absoluteheightroofbase description_updatedate</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                115.16                105.00            2006-08-30          Not Assessed                 10.16                 110.85             2006-08-30</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                  7.29                  5.39            2015-03-11          Not Assessed                  1.90                   6.21             2015-10-29</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                 38.63                 34.70            1993-04-01          Not Assessed                  3.93                  37.13             1993-04-01</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                 72.80                 69.99            1993-05-01          Not Assessed                  2.81                  71.95             1993-05-01</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   oslandcover_updatedate oslanduse_evidencedate relativeheightroofbase versionavailabletodate firstdigitalcapturedate description_evidencedate</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1             2006-08-30             2006-08-30                   5.85                   &lt;NA&gt;              1991-09-18               2006-08-30</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2             2015-10-29             2015-03-11                   0.82                   &lt;NA&gt;              2015-11-12               2015-03-11</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3             1993-04-01             1993-04-01                   2.43                   &lt;NA&gt;              1993-04-01               1993-04-01</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4             1993-05-01             1993-05-01                   1.96                   &lt;NA&gt;              1993-05-01               1993-05-01</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   oslandcover_evidencedate versionavailablefromdate                       geometry</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1               2006-08-30      2022-09-19 01:00:00 POLYGON ((-3.970308 55.7425...</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2               2015-03-11      2022-08-27 01:00:00 POLYGON ((1.727559 52.66142...</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3               1993-04-01      2022-08-27 01:00:00 POLYGON ((0.1941514 51.5924...</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4               1993-05-01      2022-08-27 01:00:00 POLYGON ((-1.454721 52.3961...</span></span></code></pre></div>
<p>Alternatively, it’s possible to return an <code>sf</code> object
directly from the NGD query function:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># retrieve features and automatically convert to spatial data frame</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>features <span class="ot">&lt;-</span> <span class="fu">query_ngd</span>(<span class="at">collection =</span> collection,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">max_results =</span> <span class="dv">4</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">returnType =</span> <span class="st">&#39;sf&#39;</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(features)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 4 features and 39 fields</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -3.97032 ymin: 51.59236 xmax: 1.727559 ymax: 55.7426</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   osid                 toid     theme          changetype isobscured description versiondate geometry_area   height_source</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 000000b1-0556-4231-a52a-9b5b8b82dfbf    osgb1000041024621 Buildings Modified Attributes      FALSE    Building  2022-09-18     59.200650 Ordnance Survey</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 00000183-3ae0-4f05-adb8-a5792d09f55f osgb5000005167584940 Buildings                 New      FALSE    Building  2022-08-26      9.499142 Ordnance Survey</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 000001d6-8217-4f7a-a70e-3757eb76c9e4    osgb1000000360448 Buildings                 New      FALSE    Building  2022-08-26     15.258750 Ordnance Survey</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 00000208-a659-49f9-a587-ab26cb2b2248    osgb1000017249389 Buildings                 New      FALSE    Building  2022-08-26     12.806250 Ordnance Survey</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   physicallevel               oslandusetiera        oslandusetierb geometry_source oslandcovertiera oslandcovertierb oslanduse_source height_updatedate</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Surface Level    Residential Accommodation [&quot;Private Residence&quot;] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey        2022-08-24</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Surface Level    Residential Accommodation [&quot;Private Residence&quot;] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey        2022-08-24</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Surface Level    Residential Accommodation [&quot;Private Residence&quot;] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey        2022-08-24</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Surface Level Unknown Or Unused Artificial                    [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey        2022-08-24</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   description_source oslandcover_source associatedstructure geometry_updatedate height_evidencedate capturespecification oslanduse_updatedate</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          2006-08-30          2022-06-20                Urban           2006-08-30</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          2015-10-29          2022-04-16                Rural           2015-10-29</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          1993-04-01          2022-07-10                Urban           1993-04-01</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          1993-05-01          2022-02-27                Urban           1993-05-01</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   absoluteheightmaximum absoluteheightminimum geometry_evidencedate heightconfidencelevel relativeheightmaximum absoluteheightroofbase description_updatedate</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                115.16                105.00            2006-08-30          Not Assessed                 10.16                 110.85             2006-08-30</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                  7.29                  5.39            2015-03-11          Not Assessed                  1.90                   6.21             2015-10-29</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                 38.63                 34.70            1993-04-01          Not Assessed                  3.93                  37.13             1993-04-01</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                 72.80                 69.99            1993-05-01          Not Assessed                  2.81                  71.95             1993-05-01</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   oslandcover_updatedate oslanduse_evidencedate relativeheightroofbase versionavailabletodate firstdigitalcapturedate description_evidencedate</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1             2006-08-30             2006-08-30                   5.85                   &lt;NA&gt;              1991-09-18               2006-08-30</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2             2015-10-29             2015-03-11                   0.82                   &lt;NA&gt;              2015-11-12               2015-03-11</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3             1993-04-01             1993-04-01                   2.43                   &lt;NA&gt;              1993-04-01               1993-04-01</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4             1993-05-01             1993-05-01                   1.96                   &lt;NA&gt;              1993-05-01               1993-05-01</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   oslandcover_evidencedate versionavailablefromdate                       geometry</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1               2006-08-30     2022-09-19T00:00:00Z POLYGON ((-3.970308 55.7425...</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2               2015-03-11     2022-08-27T00:00:00Z POLYGON ((1.727559 52.66142...</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3               1993-04-01     2022-08-27T00:00:00Z POLYGON ((0.1941514 51.5924...</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4               1993-05-01     2022-08-27T00:00:00Z POLYGON ((-1.454721 52.3961...</span></span></code></pre></div>
</div>
</div>
<div id="adding-filters" class="section level2">
<h2>4. Adding Filters</h2>
<p>Filters can help you limit the scope of your query using spatial,
temporal and contextual parameters. The NGD Features API uses Common
Query Language (CQL) to allow you to filter data using the attribution
set of each collection.</p>
<ul>
<li>Spatial: <code>extent</code></li>
</ul>
<p>You can specify any polygon to query by using the functions in
<code>osdatahub</code> to create extents. You can learn more about using
extents here.</p>
<ul>
<li>Temporal: <code>state_datetime</code> and
<code>end_datetime</code></li>
</ul>
<p>If you want to only get features that have a temporal property, you
can specify date ranges to query within. If youw ant to get features for
a single time, simply provide the same argument for both parameters.</p>
<ul>
<li>Contextual: <code>cql_filter</code></li>
</ul>
<p>The NGD API supports a generic filter grammar called the Common Query
Language (CQL) to further filter your query using human readable
commands. You can find out more about the operations that the API
supports in the Queryables section of the <a href="https://osdatahub.os.uk/docs/ofa/technicalSpecification">Technical
Specification</a>. The CQL filter allows you to specify specific
properties for features as well as spatial filters.</p>
<p>In addition, the <code>osdatahub</code> package permits you to
specify the maximum number of features to return (by default, 100
features):</p>
<ul>
<li><code>max_results</code></li>
</ul>
<p>Allows you to specify the maximum number of features you’d like to
receive. Default is 100.</p>
<ul>
<li><code>offset</code></li>
</ul>
<p>Skips past the specified number of features in the collection.
Default is 0.</p>
<div id="specifying-an-extent-bounding-box" class="section level3">
<h3>Specifying an Extent (Bounding Box)</h3>
<p>In our case, we want to get features that are only within a certain
bounding box in Manchester. We can specify an extent based on the
geometry, and then pass this into the query:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>extent <span class="ot">=</span> <span class="fu">extent_from_bbox</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.244973</span>, <span class="fl">53.476620</span>, <span class="sc">-</span><span class="fl">2.237799</span>, <span class="fl">53.480525</span>),</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">crs =</span> <span class="st">&#39;CRS84&#39;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the &#39;extent&#39; as the first parameter to define the type of query.</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>features <span class="ot">=</span> <span class="fu">query_ngd</span>(<span class="at">x =</span> extent,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">collection =</span> collection,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">max_results =</span> <span class="dv">4</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">returnType =</span> <span class="st">&#39;sf&#39;</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># run this cell to see the contents of &#39;features&#39;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>features</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 4 features and 39 fields</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -2.241707 ymin: 53.47689 xmax: -2.23773 ymax: 53.48008</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   osid                 toid     theme          changetype isobscured description versiondate geometry_area   height_source</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 02837688-4553-4d32-87aa-10733dad9274    osgb1000024157902 Buildings                 New      FALSE    Building  2022-08-26      21.57975 Ordnance Survey</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 02c6f2c7-0e25-4224-b4a7-c62c7d476e48    osgb1000024157913 Buildings Modified Attributes      FALSE    Building  2023-06-03     441.13125 Ordnance Survey</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0364fa8b-024a-4078-ae13-4a3e21c5e744    osgb1000024155721 Buildings                 New      FALSE    Building  2022-08-26     173.96250 Ordnance Survey</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 04b6b1d7-2a73-4173-b953-20c3ef2e6ce7 osgb5000005290155401 Buildings Modified Attributes      FALSE    Building  2022-09-26      45.44059            &lt;NA&gt;</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   physicallevel               oslandusetiera        oslandusetierb geometry_source oslandcovertiera oslandcovertierb oslanduse_source height_updatedate</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Surface Level Unknown Or Unused Artificial                    [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey        2022-08-24</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Surface Level  Commercial Activity: Retail                    [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey        2022-08-24</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Surface Level Unknown Or Unused Artificial                    [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey        2022-08-24</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Surface Level    Residential Accommodation [&quot;Private Residence&quot;] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey              &lt;NA&gt;</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   description_source oslandcover_source associatedstructure geometry_updatedate height_evidencedate capturespecification oslanduse_updatedate</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          2016-10-26          2021-04-19                Urban           1993-05-01</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          2010-04-13          2021-04-19                Urban           2010-04-13</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          1993-05-01          2021-04-19                Urban           1993-05-01</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          2021-11-30                &lt;NA&gt;                Urban           2021-11-30</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   absoluteheightmaximum absoluteheightminimum geometry_evidencedate heightconfidencelevel relativeheightmaximum absoluteheightroofbase description_updatedate</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                 68.98                 43.34            2016-10-04          Not Assessed                 25.64                  66.54             1993-05-01</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                 67.69                 44.22            2010-04-13          Not Assessed                 23.47                  60.87             2010-04-13</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                 57.17                 42.16            1993-05-01          Not Assessed                 15.01                  52.83             1993-05-01</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                    NA                    NA            2021-11-30                  &lt;NA&gt;                    NA                     NA             2021-11-30</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   oslandcover_updatedate oslanduse_evidencedate relativeheightroofbase versionavailabletodate firstdigitalcapturedate description_evidencedate</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1             1993-05-01             1993-05-01                  23.20                   &lt;NA&gt;              1993-05-01               1993-05-01</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2             2010-04-13             2010-04-13                  16.65                   &lt;NA&gt;              1993-05-01               2010-04-13</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3             1993-05-01             1993-05-01                  10.67                   &lt;NA&gt;              1993-05-01               1993-05-01</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4             2021-11-30             2021-11-30                     NA                   &lt;NA&gt;              2021-11-30               2021-11-30</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   oslandcover_evidencedate versionavailablefromdate                       geometry</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1               1993-05-01     2022-08-27T00:00:00Z POLYGON ((-2.240982 53.4790...</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2               2010-04-13     2023-06-04T00:00:00Z POLYGON ((-2.241351 53.4798...</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3               1993-05-01     2022-08-27T00:00:00Z POLYGON ((-2.240074 53.4781...</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4               2021-11-30     2022-09-27T00:00:00Z POLYGON ((-2.23773 53.47692...</span></span></code></pre></div>
</div>
<div id="custom-paging-parameters" class="section level3">
<h3>Custom Paging Parameters</h3>
<p>By default, <code>osdatahub</code> will return a maximum 100 features
to a query - starting at zero. This behaviour can be altered by
specifying <code>max_results</code> and <code>offset</code> parameters.
<em>We’ll be building on the previous example, specifying the same
extent as before…</em></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns a maximum of 4 results (features 1 to 4)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>features <span class="ot">=</span> <span class="fu">query_ngd</span>(extent,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">collection =</span> collection,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">max_results =</span> <span class="dv">4</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># returns a maximum of 4 results (features 101 to 104)</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>features <span class="ot">=</span> <span class="fu">query_ngd</span>(extent,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">collection =</span> collection,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">offset =</span> <span class="dv">100</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">max_results =</span> <span class="dv">4</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">returnType =</span> <span class="st">&#39;sf&#39;</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># run this cell to see the contents of &#39;features&#39;</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>features</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 4 features and 39 fields</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -2.2437 ymin: 53.47765 xmax: -2.238997 ymax: 53.47982</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   osid                 toid     theme changetype isobscured description versiondate geometry_area   height_source physicallevel</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 4e1a5c52-aa3f-4c99-a216-f3ad0b5aff83    osgb1000024155766 Buildings        New      FALSE    Building  2022-08-26      64.48625 Ordnance Survey Surface Level</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 50b0ab14-2a1a-41ae-8425-6ddafbddb575    osgb1000024155767 Buildings        New      FALSE    Building  2022-08-26     457.61400 Ordnance Survey Surface Level</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 52335576-4e7b-47f8-ab79-a644172032f0    osgb1000024155700 Buildings        New      FALSE    Building  2022-08-26     166.62625 Ordnance Survey Surface Level</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 537d6ba9-5902-4e6b-b193-ad604a1570b9 osgb1000002517038005 Buildings        New      FALSE    Building  2022-08-26    1018.93900 Ordnance Survey Surface Level</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 oslandusetiera oslandusetierb geometry_source oslandcovertiera oslandcovertierb oslanduse_source height_updatedate description_source</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  Commercial Activity: Retail             [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey        2022-08-24    Ordnance Survey</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  Commercial Activity: Retail             [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey        2022-08-24    Ordnance Survey</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Unknown Or Unused Artificial             [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey        2022-08-24    Ordnance Survey</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Unknown Or Unused Artificial             [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey        2022-08-24    Ordnance Survey</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   oslandcover_source associatedstructure geometry_updatedate height_evidencedate capturespecification oslanduse_updatedate absoluteheightmaximum</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    Ordnance Survey                &lt;NA&gt;          1993-05-01          2021-04-19                Urban           1993-05-01                 63.80</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    Ordnance Survey                &lt;NA&gt;          2002-10-08          2021-04-19                Urban           2002-10-08                 69.45</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    Ordnance Survey                &lt;NA&gt;          2010-04-28          2021-04-19                Urban           2010-04-28                 63.78</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    Ordnance Survey                &lt;NA&gt;          2007-03-22          2021-04-19                Urban           2007-03-22                 70.57</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   absoluteheightminimum geometry_evidencedate heightconfidencelevel relativeheightmaximum absoluteheightroofbase description_updatedate oslandcover_updatedate</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                 41.84            1993-05-01          Not Assessed                 21.96                  62.62             1993-05-01             1993-05-01</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                 41.20            2002-10-08          Not Assessed                 28.25                  61.31             2002-10-08             2002-10-08</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                 42.59            2010-04-28          Not Assessed                 21.19                  61.16             2010-04-28             2010-04-28</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                 41.34            2007-03-22          Not Assessed                 29.23                  59.01             2007-03-22             2007-03-22</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   oslanduse_evidencedate relativeheightroofbase versionavailabletodate firstdigitalcapturedate description_evidencedate oslandcover_evidencedate</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1             1993-05-01                  20.78                   &lt;NA&gt;              1993-05-01               1993-05-01               1993-05-01</span></span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2             2002-10-08                  20.11                   &lt;NA&gt;              1993-05-01               2002-10-08               2002-10-08</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3             2010-04-28                  18.57                   &lt;NA&gt;              1993-05-01               2010-04-28               2010-04-28</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4             2007-03-22                  17.67                   &lt;NA&gt;              2007-03-22               2007-03-22               2007-03-22</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   versionavailablefromdate                       geometry</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     2022-08-27T00:00:00Z POLYGON ((-2.241327 53.4780...</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     2022-08-27T00:00:00Z POLYGON ((-2.24123 53.47778...</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     2022-08-27T00:00:00Z POLYGON ((-2.238997 53.4783...</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     2022-08-27T00:00:00Z POLYGON ((-2.243258 53.4794...</span></span></code></pre></div>
</div>
<div id="applying-cql-filters" class="section level3">
<h3>Applying CQL Filters</h3>
<p>Common Query Language (CQL) filters are a handy way in which you can
tailor the results of your query to match specific needs. More
information on CQL filters can be found <a href="https://labs.os.uk/public/osngd/os-ngd-api-features/">here</a>. We
can pass a filter in the API using the <code>filter</code>
parameter.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Building off the same extent covering Manchester, filtering by buildings</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># larger than or equal to 20m^2 and with a maximum height greater than 60m.</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># At the time of writing, this returns 7 features (buildings)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>features <span class="ot">=</span> <span class="fu">query_ngd</span>(extent,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">collection =</span> collection,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">cql_filter=</span><span class="st">&#39;geometry_area&gt;=200 AND relativeheightmaximum&gt;60&#39;</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">returnType =</span> <span class="st">&#39;sf&#39;</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># run this cell to see the contents of &#39;features&#39;</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>features</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 7 features and 39 fields</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -2.243508 ymin: 53.47677 xmax: -2.237916 ymax: 53.48044</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                   osid                 toid     theme          changetype isobscured description versiondate geometry_area   height_source</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 40fa2462-4c01-48d4-bcf1-5179efb56027 osgb5000005134737612 Buildings                 New      FALSE    Building  2022-08-26     2122.6936 Ordnance Survey</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 41ab80d3-28ca-460f-9afe-04671aa2807a osgb1000002517080496 Buildings                 New      FALSE    Building  2022-08-26      687.8187 Ordnance Survey</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 8a98fdc7-bc44-4ac0-8c20-aac5c7ddcf30 osgb1000002517080494 Buildings                 New      FALSE    Building  2022-08-26      206.9899 Ordnance Survey</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 8ce5ac53-d4ee-492d-9b6d-56b069252cbe    osgb1000024155687 Buildings Modified Attributes      FALSE    Building  2023-06-22      748.7997 Ordnance Survey</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 a1007205-9f06-4a36-bcba-45de245d9faf osgb5000005134737702 Buildings                 New      FALSE    Building  2022-08-26      380.3845 Ordnance Survey</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 af43ce9a-18d2-47d2-9744-fdc89f7c241c osgb5000005267089134 Buildings                 New      FALSE    Building  2022-08-26     1590.4881 Ordnance Survey</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 cfe4934e-8360-40bb-81eb-5f49d240c2b8 osgb5000005275364197 Buildings Modified Attributes      FALSE    Building  2023-06-22     1143.7811 Ordnance Survey</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   physicallevel                                   oslandusetiera oslandusetierb geometry_source oslandcovertiera oslandcovertierb oslanduse_source</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 Surface Level Commercial Activity: Industrial Or Manufacturing             [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 Surface Level                     Unknown Or Unused Artificial             [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 Surface Level                     Unknown Or Unused Artificial             [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 Surface Level                              Government Services             [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 Surface Level                     Unknown Or Unused Artificial             [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 Surface Level Commercial Activity: Industrial Or Manufacturing             [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 Surface Level               Temporary Or Holiday Accommodation             [] Ordnance Survey      Constructed     [&quot;Building&quot;]  Ordnance Survey</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   height_updatedate description_source oslandcover_source associatedstructure geometry_updatedate height_evidencedate capturespecification oslanduse_updatedate</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        2022-08-24    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          2017-09-26          2021-04-19                Urban           2014-09-26</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        2022-08-24    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          2009-06-25          2021-04-19                Urban           2009-06-25</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        2022-08-24    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          2009-06-25          2021-04-19                Urban           2009-06-25</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        2022-08-24    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          2014-11-19          2021-04-19                Urban           2010-03-18</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        2022-08-24    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          2014-10-13          2021-04-19                Urban           2014-10-13</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        2022-08-24    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          2020-07-16          2021-04-19                Urban           2020-07-16</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7        2022-08-24    Ordnance Survey    Ordnance Survey                &lt;NA&gt;          2021-01-13          2021-04-19                Urban           2021-01-13</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   absoluteheightmaximum absoluteheightminimum geometry_evidencedate heightconfidencelevel relativeheightmaximum absoluteheightroofbase description_updatedate</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1                102.52                 38.65            2017-09-26          Not Assessed                 63.87                  94.76             2014-09-26</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2                105.48                 43.20            2009-06-25          Not Assessed                 62.28                 100.70             2009-06-25</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3                104.38                 43.17            2009-06-25          Not Assessed                 61.21                  88.38             2009-06-25</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4                116.73                 43.13            2013-11-04          Not Assessed                 73.60                 109.57             2010-03-18</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5                 99.96                 39.25            2014-10-13          Not Assessed                 60.71                  94.68             2014-10-13</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6                102.53                 38.69            2020-07-16          Not Assessed                 63.84                  95.19             2020-07-16</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7                112.00                 40.06            2021-01-13          Not Assessed                 71.94                 107.00             2021-01-13</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   oslandcover_updatedate oslanduse_evidencedate relativeheightroofbase versionavailabletodate firstdigitalcapturedate description_evidencedate</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1             2014-09-26             2013-11-04                  56.11                   &lt;NA&gt;              2014-10-21               2013-11-04</span></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2             2009-06-25             2009-06-25                  57.50                   &lt;NA&gt;              2009-06-25               2009-06-25</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3             2009-06-25             2009-06-25                  45.21                   &lt;NA&gt;              2009-06-25               2009-06-25</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4             2010-03-18             2010-03-18                  66.44                   &lt;NA&gt;              1993-05-01               2010-03-18</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5             2014-10-13             2014-10-13                  55.43                   &lt;NA&gt;              2014-10-21               2014-10-13</span></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6             2020-07-16             2020-07-16                  56.50                   &lt;NA&gt;              2020-07-16               2020-07-16</span></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7             2021-01-13             2021-01-13                  66.94                   &lt;NA&gt;              2021-01-13               2021-01-13</span></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   oslandcover_evidencedate versionavailablefromdate                       geometry</span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1               2013-11-04     2022-08-27T00:00:00Z POLYGON ((-2.242897 53.4772...</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2               2009-06-25     2022-08-27T00:00:00Z POLYGON ((-2.242983 53.4804...</span></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3               2009-06-25     2022-08-27T00:00:00Z POLYGON ((-2.242827 53.4801...</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4               2010-03-18     2023-06-23T00:00:00Z POLYGON ((-2.238278 53.4780...</span></span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5               2014-10-13     2022-08-27T00:00:00Z POLYGON ((-2.242894 53.4777...</span></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6               2020-07-16     2022-08-27T00:00:00Z POLYGON ((-2.2422 53.47719,...</span></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7               2021-01-13     2023-06-23T00:00:00Z POLYGON ((-2.241926 53.4779...</span></span></code></pre></div>
</div>
</div>
<div id="conclusion" class="section level2">
<h2>5. Conclusion</h2>
<p>We hope this short introduction to the <code>osdatahub</code>
package’s new NGD capabilities has been useful! You can find further
resources to assist you on your OS API development journal at: <a href="https://github.com/OrdnanceSurvey/os-api-resources">https://github.com/OrdnanceSurvey/os-api-resources</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
